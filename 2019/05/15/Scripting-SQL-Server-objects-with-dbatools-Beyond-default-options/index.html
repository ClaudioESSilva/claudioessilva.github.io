<!doctype html><html lang=en-us><head><script type=application/ld+json>{"@context":"http://schema.org","@type":"Website","@id":"https:\/\/claudioessilva.eu","author":{"@type":"Person","name":"Cláudio Silva","image":"https://claudioessilva.eu/img/avatar.jpg"},"name":"Cláudio Silva\u0027s Blog","description":"Probably you had the need to script out some objects from a SQL Server instance\/database and this is quite easy. You just need to right click on the object (well\u0026hellip;not on every single one, try it with an Availability Group :-), no script option available) select \u0026ldquo;Script XXXX as\u0026rdquo; and you have it.\nBut have you realized that this option doesn\u0026rsquo;t bring all the stuff? Let\u0026rsquo;s say you are scripting a table and you have a Non-Clustered index or a trigger\u0026hellip;using this option some of the objects under the table will not be scripted out.","url":"https:\/\/claudioessilva.eu\/2019\/05\/15\/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options\/","keywords":"[]"}</script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo 0.122.0 with theme Tranquilpeak 0.5.3-BETA"><meta name=author content="Cláudio Silva"><meta name=keywords content><meta name=description content="Probably you had the need to script out some objects from a SQL Server instance/database and this is quite easy. You just need to right click on the object (well&mldr;not on every single one, try it with an Availability Group :-), no script option available) select &ldquo;Script XXXX as&rdquo; and you have it.
But have you realized that this option doesn&rsquo;t bring all the stuff? Let&rsquo;s say you are scripting a table and you have a Non-Clustered index or a trigger&mldr;using this option some of the objects under the table will not be scripted out."><meta property="og:description" content="Probably you had the need to script out some objects from a SQL Server instance/database and this is quite easy. You just need to right click on the object (well&mldr;not on every single one, try it with an Availability Group :-), no script option available) select &ldquo;Script XXXX as&rdquo; and you have it.
But have you realized that this option doesn&rsquo;t bring all the stuff? Let&rsquo;s say you are scripting a table and you have a Non-Clustered index or a trigger&mldr;using this option some of the objects under the table will not be scripted out."><meta property="og:type" content="article"><meta property="og:title" content="Scripting SQL Server objects with dbatools - Beyond default options"><meta name=twitter:title content="Scripting SQL Server objects with dbatools - Beyond default options"><meta property="og:url" content="https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/"><meta property="twitter:url" content="https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/"><meta property="og:site_name" content="Cláudio Silva's Blog"><meta property="og:description" content="Probably you had the need to script out some objects from a SQL Server instance/database and this is quite easy. You just need to right click on the object (well&mldr;not on every single one, try it with an Availability Group :-), no script option available) select &ldquo;Script XXXX as&rdquo; and you have it.
But have you realized that this option doesn&rsquo;t bring all the stuff? Let&rsquo;s say you are scripting a table and you have a Non-Clustered index or a trigger&mldr;using this option some of the objects under the table will not be scripted out."><meta name=twitter:description content="Probably you had the need to script out some objects from a SQL Server instance/database and this is quite easy. You just need to right click on the object (well&mldr;not on every single one, try it with an Availability Group :-), no script option available) select &ldquo;Script XXXX as&rdquo; and you have it.
But have you realized that this option doesn&rsquo;t bring all the stuff? Let&rsquo;s say you are scripting a table and you have a Non-Clustered index or a trigger&mldr;using this option some of the objects under the table will not be scripted out."><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2019-05-15T00:00:00"><meta property="article:modified_time" content="2019-05-15T00:00:00"><meta property="article:tag" content="Automation"><meta property="article:tag" content="dbatools"><meta property="article:tag" content="PowerShell"><meta property="article:tag" content="Scripting"><meta property="article:tag" content="SMO"><meta property="article:tag" content="SQLServer"><meta property="article:tag" content="syndicated"><meta property="article:tag" content="T-SQL"><meta name=twitter:card content="summary"><meta name=twitter:site content="@claudioessilva"><meta name=twitter:creator content="@claudioessilva"><meta property="og:image" content="https://claudioessilva.eu/img/avatar.jpg"><meta property="twitter:image" content="https://claudioessilva.eu/img/avatar.jpg"><title>Scripting SQL Server objects with dbatools - Beyond default options</title>
<link rel=icon href=https://claudioessilva.eu/img/favicon.jpg><link rel=canonical href=https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://claudioessilva.eu/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-27703765-1","auto"),ga("send","pageview"))</script></head><body><div id=blog><header id=header data-behavior=4><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=/ aria-label="Go to homepage">Cláudio Silva's Blog</a></div><a class=header-right-picture href=/#about aria-label="Open the link: /#about"><img class=header-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"></a></header><nav id=sidebar data-behavior=4><div class=sidebar-container><div class=sidebar-profile><a href=/#about aria-label="Read more about the author"><img class=sidebar-profile-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"></a><h4 class=sidebar-profile-name>Cláudio Silva</h4><h5 class=sidebar-profile-bio>Data Platform Architect and PowerShell lover.</h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/ title=Home><i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden=true></i>
<span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/tags title=Tags><i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden=true></i>
<span class=sidebar-button-desc>Tags</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/#about title=About><i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden=true></i>
<span class=sidebar-button-desc>About</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/claudioessilva target=_blank rel=noopener title=GitHub><i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden=true></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://twitter.com/claudioessilva target=_blank rel=noopener title=Twitter><i class="sidebar-button-icon fab fa-lg fa-twitter" aria-hidden=true></i>
<span class=sidebar-button-desc>Twitter</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.linkedin.com/in/claudioessilva target=_blank rel=noopener title=LinkedIn><i class="sidebar-button-icon fab fa-lg fa-linkedin" aria-hidden=true></i>
<span class=sidebar-button-desc>LinkedIn</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/index.xml title=RSS><i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden=true></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul></div><div class=sidebar-container><div style=color:#ebebeb;font-size:25px;text-align:center>dbatools book</div><div style=color:#ebebeb;font-size:15px>Now available! Buy it at manning.com - 50% off with code bldbatools50</div><a href="https://www.manning.com/books/learn-dbatools-in-a-month-of-lunches?utm_source=claudioessilva&utm_medium=affiliate&utm_campaign=affiliate&a_aid=claudioessilva" target=_blank><center><img src=https://images.manning.com/264/352/resize/book/0/998b76f-982a-4661-a020-5d94909f7ea5/LeMaire-HI.png height=300></center></a></div></nav><div id=main data-behavior=4 class=hasCoverMetaIn><article class=post id=top><div class="post-header main-content-wrap text-left"><h1 class=post-title>Scripting SQL Server objects with dbatools - Beyond default options</h1><div class="postShorten-meta post-meta"><time datetime=2019-05-15T00:00:00Z>May 15, 2019</time></div></div><div class="post-content markdown"><div class=main-content-wrap><p>Probably you had the need to script out some objects from a SQL Server instance/database and this is quite easy. You just need to right click on the object (well&mldr;not on every single one, try it with an Availability Group :-), no script option available) select &ldquo;Script XXXX as&rdquo; and you have it.</p><p>But have you realized that this option doesn&rsquo;t bring all the stuff?
Let&rsquo;s say you are scripting a table and you have a Non-Clustered index or a trigger&mldr;using this option some of the objects under the table will not be scripted out. I understand this as each one of this is a different object, which means if you go to each one you can right click and script just that one.</p><h2 id=ssms---generate-scripts-option>SSMS - &ldquo;Generate Scripts&mldr;&rdquo; option</h2><p>This is a tedious work and you can easily miss some objects. What can we do on SSMS to make this task easier?</p><p>You can accomplish this task by using the &ldquo;Generate Scripts&mldr;&rdquo; option under &ldquo;Tasks&rdquo; when you right-click on the database:
<img src=/img/2019/05/ssms_generatescripts.png alt=ssms_generatescripts></p><p>This will open the wizard and at the &ldquo;Set Scripting Options&rdquo; you can just click on the &ldquo;Advanced&rdquo; button and there you can change the properties.
Here you can see that some defaults are in place, and &ldquo;Script Indexes&rdquo; is one of them.
<img src=/img/2019/05/ssms_scriptingoptions.png alt=ssms_scriptingoptions></p><p>This is much easier right? All-in-one in a single scripting operation.</p><p>What about automating this task? You want to script out multiple objects from different instances/databases.</p><h2 id=enter-dbatools-export--commands>Enter dbatools&rsquo; &ldquo;Export-&rdquo; commands</h2><p>To search for commands within <a href=https://dbatools.io target=_blank rel="noopener noreferrer">dbatools
</a>we can use the <a href=https://docs.dbatools.io/#Find-DbaCommand target=_blank rel="noopener noreferrer">Find-DbaCommand
</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Find-DbaCommand -Tag Export
</span></span></code></pre></div><p><img src=/img/2019/05/find-dbacommand_export.png alt=find-dbacommand_export></p><p>This command give to us a nice <code>Synopsis</code> text that help to find which command is the one we want. From the output we can see that we have (as of v0.9.824) 5 commands tagged as Export.</p><p>To replicate our SSMS example using PowerShell we will use the <code>Export-DbaScript</code>.</p><p>Don&rsquo;t forget to use <code>Get-Help</code> cmdlet to find the available parameters and get some examples on how you can use the command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Get-Help Export-DbaScript -Detailed
</span></span></code></pre></div><p><strong>Tip:</strong> Try other switches like <code>-Examples</code> or even <code>-ShowWindow</code> (won&rsquo;t work on PSCore but dbatools does!) switches.</p><h3 id=example-using-our-mytable-object>Example using our &ldquo;MyTable&rdquo; object</h3><p>Here is how <code>MyTable</code> looks like:
<img src=/img/2019/05/mytable_treedefinition.png alt=mytable_treedefinition></p><ul><li>3 Columns</li><li>1 Default constraint</li><li>1 Non-Clustered Index</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Get-DbaDbTable -SqlInstance SQL1 -Database DB1 -Table MyTable | Export-DbaScript -Passthru
</span></span></code></pre></div><p>Note: I&rsquo;m using <code>-PassThru</code> parameter to output the script to the console, by default it will create a SQL file.</p><p><img src=/img/2019/05/export-dbascript_defaultoutput.png alt=export-dbascript_defaultoutput></p><p>The output of this execution is even more incomplete when comparing with SSMS. Here, we dont even get the default constraint scripted.</p><h2 id=using-new-dbascriptingoption-command>Using &ldquo;New-DbaScriptingOption&rdquo; command</h2><p>dbatools has a command that makes it possible to create an object of type <code>ScriptingOptions</code>.
Then we can change the properties like we have done before on the &ldquo;Generate Scripts&mldr;&rdquo; option on SSMS.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$options = New-DbaScriptingOption
</span></span><span style=display:flex><span>$options | Get-Member
</span></span></code></pre></div><p>Use <code>Get-Member</code> so you can see what properties the object offers.
<img src=/img/2019/05/scriptingoptions_get-member.png alt=scriptingoptions_get-member></p><p>Here we start seeing what we need.</p><p>By default what are the values of properties like <code>NonClusteredIndexes</code> and <code>DriDefaults</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$options = New-DbaScriptingOption
</span></span><span style=display:flex><span>$options.NonClusteredIndexes
</span></span><span style=display:flex><span>$options.DriDefaults
</span></span></code></pre></div><p><img src=/img/2019/05/nci_dridefaults_defaultvalue.png alt=nci_dridefaults_defaultvalue></p><p><code>False</code>! That explains why they are &ldquo;missing&rdquo; from our default <code>Export-DbaScript</code> output.</p><p>NOTE: <code>Export-DbaUser</code> comamnd can also leverage on this object. Try it.</p><p>Let&rsquo;s change this options to <code>$true</code> and pass our <code>$options</code> object as the value of the <code>-ScriptingOptionsObject</code> parameter and run the command again.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$options = New-DbaScriptingOption
</span></span><span style=display:flex><span>$options.NonClusteredIndexes = $true
</span></span><span style=display:flex><span>$options.DriDefaults = $true
</span></span><span style=display:flex><span>Get-DbaDbTable -SqlInstance SQL1 -Database DB1 -Table MyTable | Export-DbaScript -Passthru -ScriptingOptionsObject $options
</span></span></code></pre></div><p><img src=/img/2019/05/export-dbascript_diffoptionsoutput.png alt=export-dbascript_diffoptionsoutput></p><p>Nice! Now we can see all the stuff.</p><h3 id=try-it-yourself>Try it yourself</h3><p>See the other options available, change the values, rerun and analyse the output.
Do you need to export it to run on a lower SQL Server version? Change the <code>TargetServerVersion</code> option</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Will script the code like SQL Server 2014</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$options.TargetServerVersion = <span style=color:#e6db74>&#34;Version120&#34;</span>
</span></span></code></pre></div><p>You want to include the &ldquo;IF NOT EXISTS&rdquo; statement? Change the &ldquo;IncludeIfNotExists&rdquo; option.</p><p>Here is an example to script out a list of tables (add more to the <code>$TableName</code> variable):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$SourceServer = <span style=color:#e6db74>&#34;SQL1&#34;</span>;
</span></span><span style=display:flex><span>$SourceDB = <span style=color:#e6db74>&#34;DB1&#34;</span>;
</span></span><span style=display:flex><span>$TableName = <span style=color:#e6db74>&#34;MyTable&#34;</span>, <span style=color:#e6db74>&#39;YourTable&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$options = New-DbaScriptingOption
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$options.DriPrimaryKey = $true
</span></span><span style=display:flex><span>$options.DriForeignKeys = $true
</span></span><span style=display:flex><span>$options.DriNonClustered = $true
</span></span><span style=display:flex><span>$options.DriChecks = $true
</span></span><span style=display:flex><span>$options.DriDefaults = $true
</span></span><span style=display:flex><span>$options.Indexes = $true
</span></span><span style=display:flex><span>$options.IncludeIfNotExists = $true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$TableName | Foreach-Object {
</span></span><span style=display:flex><span>    Get-DbaDbTable -SqlInstance $SourceServer -Database $SourceDB -Table $_ | Export-DbaScript -ScriptingOptionsObject $options -Passthru;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=availability-groups-example-using-dbatools>Availability Groups example using dbatools</h2><p>Try it yourself:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Get-DbaAvailabilityGroup -SqlInstance SQL1 -AvailabilityGroup SQL1_AG1 | Export-DbaScript -Passthru
</span></span></code></pre></div><h2 id=summary>Summary</h2><p>We have seen how we can leverage on some dbatools commands to generate T-SQL scripts from objects. This way we can versioning or just run them on other instace/database. We have seen what default options it (doesn&rsquo;t) brings and how to add more options to it.
We also saw that, for some objects, the script option is not available. As example Availability Groups, but dbatools can help you here too.</p><p>Thanks for reading!</p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">TAGGED IN</span><br><a class="tag tag--primary tag--small" href=/tags/Automation/>Automation</a>
<a class="tag tag--primary tag--small" href=/tags/dbatools/>dbatools</a>
<a class="tag tag--primary tag--small" href=/tags/PowerShell/>PowerShell</a>
<a class="tag tag--primary tag--small" href=/tags/Scripting/>Scripting</a>
<a class="tag tag--primary tag--small" href=/tags/SMO/>SMO</a>
<a class="tag tag--primary tag--small" href=/tags/SQLServer/>SQLServer</a>
<a class="tag tag--primary tag--small" href=/tags/syndicated/>syndicated</a>
<a class="tag tag--primary tag--small" href=/tags/T-SQL/>T-SQL</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2019/05/17/Ups...I-have-deleted-some-data.-Can-you-put-it-back-dbatools-for-the-rescue/ data-tooltip="'Ups...I have deleted some data. Can you put it back?' - dbatools for the rescue" aria-label="NEXT: 'Ups...I have deleted some data. Can you put it back?' - dbatools for the rescue"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2019/05/10/Access-is-denied-Using-DTCPing-utility-between-two-Windows-Server-2016/ data-tooltip="Access is denied - Using DTCPing utility between two Windows Server 2016" aria-label="PREVIOUS: Access is denied - Using DTCPing utility between two Windows Server 2016"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div><div class=comments><script src=https://utteranc.es/client.js repo=ClaudioESSilva/blog-comments issue-term=og:title theme=github-light crossorigin=anonymous async></script></div></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2024 Cláudio Silva. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=4><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2019/05/17/Ups...I-have-deleted-some-data.-Can-you-put-it-back-dbatools-for-the-rescue/ data-tooltip="'Ups...I have deleted some data. Can you put it back?' - dbatools for the rescue" aria-label="NEXT: 'Ups...I have deleted some data. Can you put it back?' - dbatools for the rescue"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2019/05/10/Access-is-denied-Using-DTCPing-utility-between-two-Windows-Server-2016/ data-tooltip="Access is denied - Using DTCPing utility between two Windows Server 2016" aria-label="PREVIOUS: Access is denied - Using DTCPing utility between two Windows Server 2016"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=4><i id=btn-close-shareoptions class="fa fa-times"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fclaudioessilva.eu%2F2019%2F05%2F15%2FScripting-SQL-Server-objects-with-dbatools-Beyond-default-options%2F" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i><span>Share on Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fclaudioessilva.eu%2F2019%2F05%2F15%2FScripting-SQL-Server-objects-with-dbatools-Beyond-default-options%2F" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i><span>Share on Twitter</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fclaudioessilva.eu%2F2019%2F05%2F15%2FScripting-SQL-Server-objects-with-dbatools-Beyond-default-options%2F" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i><span>Share on Linkedin</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-times"></i></div><img id=about-card-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"><h4 id=about-card-name>Cláudio Silva</h4><div id=about-card-bio>Data Platform Architect and PowerShell lover.</div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Data Platform Architect</div><div id=about-card-location><i class="fa fa-map-marker-alt"></i><br>Portugal</div></div></div><div id=cover style=background-image:url(https://claudioessilva.eu/images/cover_bridge.jpg)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://claudioessilva.eu/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js></script><script>$(document).ready(function(){hljs.configure({classPrefix:"",useBR:!1}),$("pre.code-highlight > code, pre > code").each(function(e,t){$(this).hasClass("codeblock")||$(this).addClass("codeblock"),hljs.highlightBlock(t)})})</script></body></html>