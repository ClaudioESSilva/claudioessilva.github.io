<!doctype html><html lang=en-us><head><script type=application/ld+json>{"@context":"http://schema.org","@type":"Website","@id":"https:\/\/claudioessilva.eu","author":{"@type":"Person","name":"Cláudio Silva","image":"https://claudioessilva.eu/img/avatar.jpg"},"name":"Cláudio Silva\u0027s Blog","description":"Who doesn\u0026rsquo;t like a good red and verbose exception?\nAt PowerShell community we often call it a \u0026ldquo;sea of red\u0026rdquo; which we found as something that can be intimidating. The bigger the error message the more problematic it is? :-)\nWe don\u0026rsquo;t think so! That\u0026rsquo;s why we, within dbatools project, try to keep the output of the exceptions more user friendly and try to give the direct error message to you.","url":"https:\/\/claudioessilva.eu\/2022\/06\/07\/dbatools-Exceptions\/","keywords":"[]"}</script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo 0.122.0 with theme Tranquilpeak 0.5.3-BETA"><meta name=author content="Cláudio Silva"><meta name=keywords content><meta name=description content="Who doesn&rsquo;t like a good red and verbose exception?
At PowerShell community we often call it a &ldquo;sea of red&rdquo; which we found as something that can be intimidating. The bigger the error message the more problematic it is? :-)
We don&rsquo;t think so! That&rsquo;s why we, within dbatools project, try to keep the output of the exceptions more user friendly and try to give the direct error message to you."><meta property="og:description" content="Who doesn&rsquo;t like a good red and verbose exception?
At PowerShell community we often call it a &ldquo;sea of red&rdquo; which we found as something that can be intimidating. The bigger the error message the more problematic it is? :-)
We don&rsquo;t think so! That&rsquo;s why we, within dbatools project, try to keep the output of the exceptions more user friendly and try to give the direct error message to you."><meta property="og:type" content="article"><meta property="og:title" content="dbatools - Exceptions"><meta name=twitter:title content="dbatools - Exceptions"><meta property="og:url" content="https://claudioessilva.eu/2022/06/07/dbatools-Exceptions/"><meta property="twitter:url" content="https://claudioessilva.eu/2022/06/07/dbatools-Exceptions/"><meta property="og:site_name" content="Cláudio Silva's Blog"><meta property="og:description" content="Who doesn&rsquo;t like a good red and verbose exception?
At PowerShell community we often call it a &ldquo;sea of red&rdquo; which we found as something that can be intimidating. The bigger the error message the more problematic it is? :-)
We don&rsquo;t think so! That&rsquo;s why we, within dbatools project, try to keep the output of the exceptions more user friendly and try to give the direct error message to you."><meta name=twitter:description content="Who doesn&rsquo;t like a good red and verbose exception?
At PowerShell community we often call it a &ldquo;sea of red&rdquo; which we found as something that can be intimidating. The bigger the error message the more problematic it is? :-)
We don&rsquo;t think so! That&rsquo;s why we, within dbatools project, try to keep the output of the exceptions more user friendly and try to give the direct error message to you."><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2022-06-07T00:00:00"><meta property="article:modified_time" content="2022-06-07T00:00:00"><meta property="article:tag" content="dbatools"><meta property="article:tag" content="Exceptions"><meta property="article:tag" content="Logging"><meta property="article:tag" content="PowerShell"><meta property="article:tag" content="SQLServer"><meta property="article:tag" content="syndicated"><meta name=twitter:card content="summary"><meta name=twitter:site content="@claudioessilva"><meta name=twitter:creator content="@claudioessilva"><meta property="og:image" content="https://claudioessilva.eu/img/2022/06/Exceptions_see_of_read_WinPS.png"><meta property="twitter:image" content="https://claudioessilva.eu/img/2022/06/Exceptions_see_of_read_WinPS.png"><meta property="og:image" content="https://claudioessilva.eu/img/2022/06/Exceptions_see_of_read_WinPS.png"><meta property="twitter:image" content="https://claudioessilva.eu/img/2022/06/Exceptions_see_of_read_WinPS.png"><meta property="og:image" content="https://claudioessilva.eu/img/2022/06/Exceptions_see_of_read_WinPS_small.png"><meta property="twitter:image" content="https://claudioessilva.eu/img/2022/06/Exceptions_see_of_read_WinPS_small.png"><title>dbatools - Exceptions</title>
<link rel=icon href=https://claudioessilva.eu/img/favicon.jpg><link rel=canonical href=https://claudioessilva.eu/2022/06/07/dbatools-Exceptions/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://claudioessilva.eu/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-27703765-1","auto"),ga("send","pageview"))</script></head><body><div id=blog><header id=header data-behavior=4><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=/ aria-label="Go to homepage">Cláudio Silva's Blog</a></div><a class=header-right-picture href=/#about aria-label="Open the link: /#about"><img class=header-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"></a></header><nav id=sidebar data-behavior=4><div class=sidebar-container><div class=sidebar-profile><a href=/#about aria-label="Read more about the author"><img class=sidebar-profile-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"></a><h4 class=sidebar-profile-name>Cláudio Silva</h4><h5 class=sidebar-profile-bio>Data Platform Architect and PowerShell lover.</h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/ title=Home><i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden=true></i>
<span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/tags title=Tags><i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden=true></i>
<span class=sidebar-button-desc>Tags</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/#about title=About><i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden=true></i>
<span class=sidebar-button-desc>About</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/claudioessilva target=_blank rel=noopener title=GitHub><i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden=true></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://twitter.com/claudioessilva target=_blank rel=noopener title=Twitter><i class="sidebar-button-icon fab fa-lg fa-twitter" aria-hidden=true></i>
<span class=sidebar-button-desc>Twitter</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.linkedin.com/in/claudioessilva target=_blank rel=noopener title=LinkedIn><i class="sidebar-button-icon fab fa-lg fa-linkedin" aria-hidden=true></i>
<span class=sidebar-button-desc>LinkedIn</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/index.xml title=RSS><i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden=true></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul></div><div class=sidebar-container><div style=color:#ebebeb;font-size:25px;text-align:center>dbatools book</div><div style=color:#ebebeb;font-size:15px>Now available! Buy it at manning.com - 50% off with code bldbatools50</div><a href="https://www.manning.com/books/learn-dbatools-in-a-month-of-lunches?utm_source=claudioessilva&utm_medium=affiliate&utm_campaign=affiliate&a_aid=claudioessilva" target=_blank><center><img src=https://images.manning.com/264/352/resize/book/0/998b76f-982a-4661-a020-5d94909f7ea5/LeMaire-HI.png height=300></center></a></div></nav><div class="post-header-cover
text-center" style=background-image:url(/img/2022/06/Exceptions_see_of_read_WinPS.png);height:30% data-behavior=4></div><div id=main data-behavior=4 class="hasCover
hasCoverMetaOut"><article class=post id=top><div class="post-header main-content-wrap text-center"><h1 class=post-title>dbatools - Exceptions</h1><div class="postShorten-meta post-meta"><time datetime=2022-06-07T00:00:00Z>June 7, 2022</time></div></div><div class="post-content markdown"><div class=main-content-wrap><p>Who doesn&rsquo;t like a good red and verbose exception?</p><p><img src=/img/2022/06/Exceptions_see_of_read_WinPS.png alt=Exceptions_see_of_read_WinPS></p><p>At PowerShell community we often call it a &ldquo;sea of red&rdquo; which we found as something that can be intimidating. The bigger the error message the more problematic it is? :-)</p><p>We don&rsquo;t think so! That&rsquo;s why we, within dbatools project, try to keep the output of the exceptions more user friendly and try to give the direct error message to you. No line numbers or stack traces to confuse you.</p><h2 id=the-default-behavior>The default behavior</h2><p>By default we hide those bigger, red and ugly error messages in favor of more useful, attractive and user-friendly ones with just the actual error text in a (yellow) warning format - identical to what you can get when using native <code>Write-Warning</code> CmdLet.</p><p>Within dbatools, if you want to have the default PowerShell look and feel error output, you will need to use the <code>-EnableException</code> parameter when calling the commands.</p><p>The only command where this doesn&rsquo;t work like that by default is for <code>Connect-DbaInstance</code>. This commands by default will shows the red message. But, if you don&rsquo;t want it you can use the <code>-DisableException</code> parameter.</p><h3 id=why-you-may-ask>&ldquo;Why?&rdquo; You may ask</h3><p>This was, in the earlier days, an internal command that others wanted us to surface and we expected they’d want it to throw by default in their own scripts.</p><h2 id=making-it-better---powershell-core---improvement>Making it better - PowerShell Core - Improvement</h2><p>If you have played with both <a href="https://docs.microsoft.com/en-us/powershell/scripting/windows-powershell/starting-windows-powershell?view=powershell-5.1" target=_blank rel="noopener noreferrer">Windows PowerShell
</a>and <a href="https://docs.microsoft.com/en-us/powershell/scripting/overview?view=powershell-7.2" target=_blank rel="noopener noreferrer">PowerShell Core
</a>, you may recognize the big difference on the default output for the error messages.
With PowerShell Core the errors are shown, by default, in a more consice and nicer view.</p><p>Here is an example when calling <code>Connect-DbaInstance</code> dbatools function.
Windows PowerShell:
<img src=/img/2022/06/Exceptions_WinPS_DefaultError_view.png alt=Exceptions_WinPS_DefaultError_view></p><p>Take a look on the same error but when using PowerShell Core
<img src=/img/2022/06/Exceptions_PSCore_DefaultError_view.png alt=Exceptions_PSCore_DefaultError_view></p><p>NOTE: You can change the default behavior of the preference variable <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_preference_variables?view=powershell-7.2#errorview" target=_blank rel="noopener noreferrer">$ErrorView
</a>and play along with <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-error?view=powershell-7.2" target=_blank rel="noopener noreferrer">Get-Error
</a>CmdLet.</p><h2 id=how-do-we-do-it>How do we do it?</h2><p>dbatools was born before PowerShell Core.<br>We were looking forward to have some better error handling along side with a better logging system and we were fortunate to have <a href=https://github.com/FriedrichWeinmann target=_blank rel="noopener noreferrer">Friedrich Weinmann
</a>on the team helping with his enormous PS/C# knowledge.</p><p>Fred created an internal CmdLet for dbatools called <a href=https://github.com/dataplat/dbatools/blob/development/bin/projects/dbatools/dbatools/Commands/WriteMessageCommand.cs target=_blank rel="noopener noreferrer"><code>Write-Message</code>
</a>to handle messages and logging.</p><p>If you explore dbatools&rsquo; functions you will find lot&rsquo;s of <code>Write-Message</code> entries but also <a href=https://github.com/dataplat/dbatools/blob/development/internal/functions/flowcontrol/Stop-Function.ps1 target=_blank rel="noopener noreferrer"><code>Stop-Function</code>
</a>which is the responsible for interrupt a function.</p><p>As stated on the description:</p><blockquote><p>This function is a utility function used by other functions to reduce error catching overhead.
It is designed to allow gracefully terminating a function with a warning by default and also allow opt-in into terminating errors.</p></blockquote><h3 id=that-means-no-write-verbosewarningerror-in-the-commands>That means no Write-Verbose/Warning/Error in the commands?</h3><p>Correct! The function <code>Write-Message</code> process the message (by type) and send it to the corresponding dbatools log and outputs it to the PowerShell <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_output_streams?view=powershell-7.2" target=_blank rel="noopener noreferrer">output streams
</a>.</p><h2 id=what-if-im-curious-about-the-details-of-the-error-message>What if I&rsquo;m curious about the details of the error message?</h2><p>As mentioned before you can use the <code>-EnableException</code> parameter to get more details.</p><p>If you feel this is not yet enough or you need to dig a bit more on the stack trace, we have a command called <code>Get-DbatoolsError</code> that allows you to navigate through the errors that happened in the context of dbatools. This will give you more details.</p><p>Hope you find it useful and that this helps understanding a little bit more how we handle exceptions in the dbatools PowerShell module.</p><p>Thanks for reading!</p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">TAGGED IN</span><br><a class="tag tag--primary tag--small" href=/tags/dbatools/>dbatools</a>
<a class="tag tag--primary tag--small" href=/tags/Exceptions/>Exceptions</a>
<a class="tag tag--primary tag--small" href=/tags/Logging/>Logging</a>
<a class="tag tag--primary tag--small" href=/tags/PowerShell/>PowerShell</a>
<a class="tag tag--primary tag--small" href=/tags/SQLServer/>SQLServer</a>
<a class="tag tag--primary tag--small" href=/tags/syndicated/>syndicated</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2024/01/29/Search-for-queries-with-Query-Store-GUI/ data-tooltip="Search for queries with Query Store GUI" aria-label="NEXT: Search for queries with Query Store GUI"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2022/06/02/dbatools-rich-datatypes/ data-tooltip="dbatools - rich datatypes" aria-label="PREVIOUS: dbatools - rich datatypes"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://claudioessilva.eu/2022/06/07/dbatools-Exceptions/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://claudioessilva.eu/2022/06/07/dbatools-Exceptions/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://claudioessilva.eu/2022/06/07/dbatools-Exceptions/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div><div class=comments><script src=https://utteranc.es/client.js repo=ClaudioESSilva/blog-comments issue-term=og:title theme=github-light crossorigin=anonymous async></script></div></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2024 Cláudio Silva. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=4><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2024/01/29/Search-for-queries-with-Query-Store-GUI/ data-tooltip="Search for queries with Query Store GUI" aria-label="NEXT: Search for queries with Query Store GUI"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2022/06/02/dbatools-rich-datatypes/ data-tooltip="dbatools - rich datatypes" aria-label="PREVIOUS: dbatools - rich datatypes"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://claudioessilva.eu/2022/06/07/dbatools-Exceptions/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://claudioessilva.eu/2022/06/07/dbatools-Exceptions/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://claudioessilva.eu/2022/06/07/dbatools-Exceptions/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=4><i id=btn-close-shareoptions class="fa fa-times"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fclaudioessilva.eu%2F2022%2F06%2F07%2Fdbatools-Exceptions%2F" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i><span>Share on Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fclaudioessilva.eu%2F2022%2F06%2F07%2Fdbatools-Exceptions%2F" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i><span>Share on Twitter</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fclaudioessilva.eu%2F2022%2F06%2F07%2Fdbatools-Exceptions%2F" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i><span>Share on Linkedin</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-times"></i></div><img id=about-card-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"><h4 id=about-card-name>Cláudio Silva</h4><div id=about-card-bio>Data Platform Architect and PowerShell lover.</div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Data Platform Architect</div><div id=about-card-location><i class="fa fa-map-marker-alt"></i><br>Portugal</div></div></div><div id=cover style=background-image:url(https://claudioessilva.eu/images/cover_bridge.jpg)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://claudioessilva.eu/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js></script><script>$(document).ready(function(){hljs.configure({classPrefix:"",useBR:!1}),$("pre.code-highlight > code, pre > code").each(function(e,t){$(this).hasClass("codeblock")||$(this).addClass("codeblock"),hljs.highlightBlock(t)})})</script></body></html>