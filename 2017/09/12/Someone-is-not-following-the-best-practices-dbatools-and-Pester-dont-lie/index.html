<!doctype html><html lang=en-us><head><script type=application/ld+json>{"@context":"http://schema.org","@type":"Website","@id":"https:\/\/claudioessilva.eu","author":{"@type":"Person","name":"Cláudio Silva","image":"https://claudioessilva.eu/img/avatar.jpg"},"name":"Cláudio Silva\u0027s Blog","description":"This month’s T-SQL Tuesday is brought to us by my good friend Rob Sewell (b | t). Together “Let’s get all Posh – What are you going to automate today?”\nI have written some blog posts on how I use PowerShell to automate mundane tasks or some other more complex scenarios like: Find and fix SQL Server databases with empty owner property using dbatools PowerShell module or Have you backed up your SQL Logins today?","url":"https:\/\/claudioessilva.eu\/2017\/09\/12\/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie\/","keywords":"[]"}</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.101.0 with theme Tranquilpeak 0.5.3-BETA"><meta name=author content="Cláudio Silva"><meta name=keywords content><meta name=description content="This month’s T-SQL Tuesday is brought to us by my good friend Rob Sewell (b | t). Together “Let’s get all Posh – What are you going to automate today?”
I have written some blog posts on how I use PowerShell to automate mundane tasks or some other more complex scenarios like: Find and fix SQL Server databases with empty owner property using dbatools PowerShell module or Have you backed up your SQL Logins today?"><meta property="og:description" content="This month’s T-SQL Tuesday is brought to us by my good friend Rob Sewell (b | t). Together “Let’s get all Posh – What are you going to automate today?”
I have written some blog posts on how I use PowerShell to automate mundane tasks or some other more complex scenarios like: Find and fix SQL Server databases with empty owner property using dbatools PowerShell module or Have you backed up your SQL Logins today?"><meta property="og:type" content="article"><meta property="og:title" content="Someone is not following the best practices - dbatools and Pester don't lie!"><meta name=twitter:title content="Someone is not following the best practices - dbatools and Pester don't lie!"><meta property="og:url" content="https://claudioessilva.eu/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/"><meta property="twitter:url" content="https://claudioessilva.eu/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/"><meta property="og:site_name" content="Cláudio Silva's Blog"><meta property="og:description" content="This month’s T-SQL Tuesday is brought to us by my good friend Rob Sewell (b | t). Together “Let’s get all Posh – What are you going to automate today?”
I have written some blog posts on how I use PowerShell to automate mundane tasks or some other more complex scenarios like: Find and fix SQL Server databases with empty owner property using dbatools PowerShell module or Have you backed up your SQL Logins today?"><meta name=twitter:description content="This month’s T-SQL Tuesday is brought to us by my good friend Rob Sewell (b | t). Together “Let’s get all Posh – What are you going to automate today?”
I have written some blog posts on how I use PowerShell to automate mundane tasks or some other more complex scenarios like: Find and fix SQL Server databases with empty owner property using dbatools PowerShell module or Have you backed up your SQL Logins today?"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2017-09-12T00:00:00"><meta property="article:modified_time" content="2017-09-12T00:00:00"><meta property="article:tag" content="BestPractices"><meta property="article:tag" content="dbatools"><meta property="article:tag" content="Pester"><meta property="article:tag" content="PowerShell"><meta property="article:tag" content="SQLServer"><meta property="article:tag" content="syndicated"><meta property="article:tag" content="Tests"><meta property="article:tag" content="Unit Test"><meta name=twitter:card content="summary"><meta name=twitter:site content="@claudioessilva"><meta name=twitter:creator content="@claudioessilva"><meta property="og:image" content="https://claudioessilva.eu/img/avatar.jpg"><meta property="twitter:image" content="https://claudioessilva.eu/img/avatar.jpg"><title>Someone is not following the best practices - dbatools and Pester don't lie!</title><link rel=icon href=https://claudioessilva.eu/img/favicon.jpg><link rel=canonical href=https://claudioessilva.eu/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://claudioessilva.eu/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-27703765-1","auto"),ga("send","pageview"))</script></head><body><div id=blog><header id=header data-behavior=4><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=/ aria-label="Go to homepage">Cláudio Silva's Blog</a></div><a class=header-right-picture href=/#about aria-label="Open the link: /#about"><img class=header-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"></a></header><nav id=sidebar data-behavior=4><div class=sidebar-container><div class=sidebar-profile><a href=/#about aria-label="Read more about the author"><img class=sidebar-profile-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"></a><h4 class=sidebar-profile-name>Cláudio Silva</h4><h5 class=sidebar-profile-bio>Data Platform Architect and PowerShell lover.</h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/ title=Home><i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden=true></i>
<span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/tags title=Tags><i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden=true></i>
<span class=sidebar-button-desc>Tags</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/#about title=About><i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden=true></i>
<span class=sidebar-button-desc>About</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/claudioessilva target=_blank rel=noopener title=GitHub><i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden=true></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://twitter.com/claudioessilva target=_blank rel=noopener title=Twitter><i class="sidebar-button-icon fab fa-lg fa-twitter" aria-hidden=true></i>
<span class=sidebar-button-desc>Twitter</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.linkedin.com/in/claudioessilva target=_blank rel=noopener title=LinkedIn><i class="sidebar-button-icon fab fa-lg fa-linkedin" aria-hidden=true></i>
<span class=sidebar-button-desc>LinkedIn</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/index.xml title=RSS><i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden=true></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul></div><div class=sidebar-container><div style=color:#ebebeb;font-size:25px;text-align:center>dbatools book</div><div style=color:#ebebeb;font-size:15px>Now available! Buy it at manning.com - 50% off with code bldbatools50</div><a href="https://www.manning.com/books/learn-dbatools-in-a-month-of-lunches?utm_source=claudioessilva&utm_medium=affiliate&utm_campaign=affiliate&a_aid=claudioessilva" target=_blank><center><img src=https://images.manning.com/264/352/resize/book/0/998b76f-982a-4661-a020-5d94909f7ea5/LeMaire-HI.png></center></a></div></nav><div id=main data-behavior=4 class=hasCoverMetaIn><article class=post id=top><div class="post-header main-content-wrap text-left"><h1 class=post-title>Someone is not following the best practices - dbatools and Pester don't lie!</h1><div class="postShorten-meta post-meta"><time datetime=2017-09-12T00:00:00Z>September 12, 2017</time></div></div><div class="post-content markdown"><div class=main-content-wrap><p>This month’s T-SQL Tuesday is brought to us by my good friend Rob Sewell (b | t). Together “Let’s get all Posh – What are you going to automate today?”</p><p>I have written some blog posts on how I use PowerShell to automate mundane tasks or some other more complex scenarios like:  Find and fix SQL Server databases with empty owner property using dbatools PowerShell module or Have you backed up your SQL Logins today?  or even using ReportingServicesTools module for deploy reports - SSRS Report Deployment Made Easy – 700 times Faster.</p><p>But today I want to bring something little different.  This year, back in May I saw two presentations from Rob about using Pester to do unit tests for our PowerShell code and also to validate options/infrastructure like checklists. This got my attention and made me want to play with it!</p><p>Therefore, I want to share an example with you using two of my favorite PowerShell modules dbatools and Pester.</p><p>For the propose of this blog, we will check:</p><p>In this post I will show some of those commands and how they can help us.</p><p>Disclaimer: Obviously this is not the only way to accomplish this request, but for me, is one excellent way!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Get-DbaDatabase -SqlServer sql2016 | Format-Table
</span></span></code></pre></div><p>This returns the following information from all existing databases on this SQL2016 instance.</p><p></p><p>To confirm this we can run the same code without the " | Format-Table" that is useful to output the information in a table format but depending on the size of your window it can show more or less columns.
By running the command without the &ldquo;format-table&rdquo; we can see the following (just showing the first 3 databases):</p><p></p><p>Now, we can see more properties available look to the ones inside the red rectangle.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$databases = Get-DbaDatabase -SqlServer sql2016
</span></span><span style=display:flex><span>$databases | Get-Member
</span></span></code></pre></div><p>Now we get a lot of stuff! The Get-Member cmdlet say to us which Properties and Methods of the object (in this case the <code>$databases</code>).</p><p>This means that I can use a filter to find results with &ldquo;auto&rdquo; in its name:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$databases | Get-Member | Where-Object Name <span style=color:#f92672>-like</span> *auto*
</span></span></code></pre></div><p>Some cmdlets have parameters that allow us to filter information without the need to pipeing it so, the last line command could be written as:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$databases | Get-Member -Name *auto*
</span></span></code></pre></div><p>Which will output something like this:</p><p></p><p>So, we have found our &ldquo;AutoShrink&rdquo; property. With this in mind, lets query all the properties we want.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$databases | Select-Object SqlInstance, Name, AutoShrink, PageVerify
</span></span></code></pre></div><p>And here we have the result:</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$databases = Get-DbaDatabase -SqlServer sql2016, sql2012
</span></span><span style=display:flex><span>$databases | Select-Object SqlInstance, Name, AutoShrink, PageVerify
</span></span></code></pre></div><p>Which outputs:</p><p></p><p>As you can see I have passed two different instances sql2016 (in red) and sql2012 (in green) and the output brought both information.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$databases | Select-Object SqlInstance, Name, AutoShrink, PageVerify | Out-GridView
</span></span></code></pre></div><p></p><p>As you can see, inside red rectangles we have two not optimal configurations regarding the SQL Server best practices. You can also see the green rectangle on the top left corner where you can type text and the results will be filter as you type. So if you type &ldquo;true&rdquo; you will end just with one record.</p><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Get-DbaMaxMemory -SqlInstance sql2012, sql2016
</span></span></code></pre></div><p></p><p>We can see that SQL2012 instance is running on a host with 6144MB of total memory but its MaxMemory setting is set to 3072MB and also, SQL2016 instance has 4608MB configured form the 18423MB existing on the host.</p><p>Example, if you want to know which commands we have that works with &ldquo;memory&rdquo; you can run the following code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Find-DbaCommand -Pattern memory
</span></span></code></pre></div><p></p><p>You may be thinking that must exists some other more automated method to accomplish that, right?</p><p>With this framework, that I really encourage you to read more about it on the project Wiki, we can automate our tests and make it do the validations for us!</p><p>As quick example - if we run the following code:</p><p>We are checking if the login returned by the <code>whoami</code> is base\claudio.</p><p></p><p>This return green which means it&rsquo;s ok!</p><p>If is not ok (because I&rsquo;m testing to &ldquo;base\claudio.silva&rdquo;), will retrieve something like this:</p><p></p><p>I will have a variable (<code>$SQLServers</code>)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$SQLServers = @(<span style=color:#e6db74>&#39;sql2012&#39;</span>, <span style=color:#e6db74>&#39;sql2014&#39;</span>, <span style=color:#e6db74>&#39;sql2016&#39;</span>)
</span></span></code></pre></div><p>with all the instances I want to test and two &ldquo;Describe&rdquo; blocks, one for &ldquo;Testing database options&rdquo; - PageVerify and AutoShrink</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Describe <span style=color:#e6db74>&#34;Testing Database Options for $Server&#34;</span> {
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>foreach</span>($Server <span style=color:#66d9ef>in</span> $SQLServers){
</span></span><span style=display:flex><span>      <span style=color:#75715e>#Just selecting some columns so it don&#39;t take too much time returning all the thing that we don&#39;t want</span>
</span></span><span style=display:flex><span>      $databases = Get-DbaDatabase -SqlServer $server | Select-Object Name, SqlInstance, CompatibilityLevel, PageVerify, AutoShrink, AutoClose
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>foreach</span>($database <span style=color:#66d9ef>in</span> $databases) {
</span></span><span style=display:flex><span>         Context <span style=color:#e6db74>&#34;</span>$($Database.Name)<span style=color:#e6db74> Validation&#34;</span> {
</span></span><span style=display:flex><span>            It <span style=color:#e6db74>&#34;PageVerfiy set to Checksum&#34;</span> {
</span></span><span style=display:flex><span>               $database.PageVerify| Should Be <span style=color:#e6db74>&#34;Checksum&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            It <span style=color:#e6db74>&#34;AutoShrink set to False&#34;</span> {
</span></span><span style=display:flex><span>               $database.AutoShrink| Should Be $false
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>         }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And another one for &ldquo;Testing instance MaxMemory&rdquo;:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Describe <span style=color:#e6db74>&#34;Testing Instance MaxMemory&#34;</span>{
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>foreach</span>($Server <span style=color:#66d9ef>in</span> $SQLServers){
</span></span><span style=display:flex><span>      $instanceMemory = Get-DbaMaxMemory -SqlInstance $Server
</span></span><span style=display:flex><span>      Context <span style=color:#e6db74>&#34;Checking MaxMemory value&#34;</span> {
</span></span><span style=display:flex><span>         It <span style=color:#e6db74>&#34;</span>$($Server)<span style=color:#e6db74> instance MaxMemory value </span>$($instanceMemory.SqlMaxMb)<span style=color:#e6db74> is less than host total memory </span>$($instanceMemory.TotalMB)<span style=color:#e6db74>&#34;</span> {
</span></span><span style=display:flex><span>            $instanceMemory.SqlMaxMb | Should BeLessThan $instanceMemory.TotalMB
</span></span><span style=display:flex><span>         }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>   }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>To run this tests we should save a file with the &ldquo;.Tests.ps1&rdquo; ending name. Let&rsquo;s save as &ldquo;SQLServerBestPractices.Tests.ps1&rdquo;. To run the tests we need to use the Invoke-Pester and the file that contains the tests.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Invoke-Pester .\SQLServerBestPractices.Tests.ps1
</span></span></code></pre></div><p></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Invoke-Pester .\SQLServerBestPractices.Tests.ps1 -Show Failed
</span></span></code></pre></div><p></p><p>But, be aware that <code>-Show Fails</code> can be a better solution, specially when you are working with multiple Tests.ps1 files.</p><p>This way you can see where your error come from.</p><p>Also, the &ldquo;PageVerify&rdquo; value that we expect to be &ldquo;Checksum&rdquo; is &ldquo;TornPageDetection&rdquo; for the database &ldquo;dumpsterfire4&rdquo; and &ldquo;SQL2016&rdquo; instance.</p><p>Finally the MaxMemory configuration on the &ldquo;SQL2016&rdquo; instance is set to 46080MB (45GB) but we expect that should be less than 18432mb (18GB) that is the total memory of the host. We need to reconfigure this value too.</p><p>If you set it to run daily or even once per week you can check your estate and get new stuff that haven&rsquo;t been you to setup and maybe is not following the best practices.</p><p>Get the fails and email them (I will blog about it).</p><p>If you want to know if there will be some dbatools presentations near you, visit our presentation page. You can find some of our presentations on our youtube channel and code example on the community presentations on GitHub.</p><p>About Pester and other examples and use cases, we have the Articles and other resources page maintained by the Pester team.</p><p>I&rsquo;m looking forward to read the other blog posts (follow the comments on Rob&rsquo;s post, or the roundup later) on this month&rsquo;s T-SQL Tuesdays and see what people is being doing with PowerShell.</p><p>Thanks for reading.</p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">TAGGED IN</span><br><a class="tag tag--primary tag--small" href=/tags/BestPractices/>BestPractices</a>
<a class="tag tag--primary tag--small" href=/tags/dbatools/>dbatools</a>
<a class="tag tag--primary tag--small" href=/tags/Pester/>Pester</a>
<a class="tag tag--primary tag--small" href=/tags/PowerShell/>PowerShell</a>
<a class="tag tag--primary tag--small" href=/tags/SQLServer/>SQLServer</a>
<a class="tag tag--primary tag--small" href=/tags/syndicated/>syndicated</a>
<a class="tag tag--primary tag--small" href=/tags/Tests/>Tests</a>
<a class="tag tag--primary tag--small" href=/tags/Unit-Test/>Unit Test</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/09/14/PowerShell-From-20-minutes-to-20-seconds-Change-domain-user-password-on-multiple-domains-without-login-into-each-one/ data-tooltip="[PowerShell] From 20 minutes to 20 seconds - Change domain user password on multiple domains without login into each one" aria-label="NEXT: [PowerShell] From 20 minutes to 20 seconds - Change domain user password on multiple domains without login into each one"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/ data-tooltip="'Invalid class [0x80041010]' error when trying to access SQLServer's WMI classes" aria-label="PREVIOUS: 'Invalid class [0x80041010]' error when trying to access SQLServer's WMI classes"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://claudioessilva.eu/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://claudioessilva.eu/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://claudioessilva.eu/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div><div class=comments><script src=https://utteranc.es/client.js repo=ClaudioESSilva/blog-comments issue-term=og:title theme=github-light crossorigin=anonymous async></script></div></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2022 Cláudio Silva. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=4><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/09/14/PowerShell-From-20-minutes-to-20-seconds-Change-domain-user-password-on-multiple-domains-without-login-into-each-one/ data-tooltip="[PowerShell] From 20 minutes to 20 seconds - Change domain user password on multiple domains without login into each one" aria-label="NEXT: [PowerShell] From 20 minutes to 20 seconds - Change domain user password on multiple domains without login into each one"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/ data-tooltip="'Invalid class [0x80041010]' error when trying to access SQLServer's WMI classes" aria-label="PREVIOUS: 'Invalid class [0x80041010]' error when trying to access SQLServer's WMI classes"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://claudioessilva.eu/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://claudioessilva.eu/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://claudioessilva.eu/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=4><i id=btn-close-shareoptions class="fa fa-times"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fclaudioessilva.eu%2F2017%2F09%2F12%2FSomeone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie%2F" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i><span>Share on Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fclaudioessilva.eu%2F2017%2F09%2F12%2FSomeone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie%2F" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i><span>Share on Twitter</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fclaudioessilva.eu%2F2017%2F09%2F12%2FSomeone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie%2F" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i><span>Share on Linkedin</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-times"></i></div><img id=about-card-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"><h4 id=about-card-name>Cláudio Silva</h4><div id=about-card-bio>Data Platform Architect and PowerShell lover.</div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Data Platform Architect</div><div id=about-card-location><i class="fa fa-map-marker-alt"></i><br>Portugal</div></div></div><div id=cover style=background-image:url(https://claudioessilva.eu/images/cover_bridge.jpg)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://claudioessilva.eu/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js></script>
<script>$(document).ready(function(){hljs.configure({classPrefix:"",useBR:!1}),$("pre.code-highlight > code, pre > code").each(function(e,t){$(this).hasClass("codeblock")||$(this).addClass("codeblock"),hljs.highlightBlock(t)})})</script></body></html>