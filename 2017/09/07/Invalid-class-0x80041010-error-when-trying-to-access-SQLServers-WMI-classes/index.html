<!doctype html><html lang=en-us><head><script type=application/ld+json>{"@context":"http://schema.org","@type":"Website","@id":"https:\/\/claudioessilva.eu\/","author":{"@type":"Person","name":"Cláudio Silva","image":"https://claudioessilva.eu/img/avatar.jpg"},"name":"Cláudio Silva\u0027s Blog","description":"I was using open source PowerShell module dbatools ( GitHub repository ) to get the list of SQL Server services I have on a bunch of hosts so I could confirm if they are in \u0026ldquo;running\u0026rdquo; state.\n\u0026ndash; Quick note \u0026ndash; For those who don’t know, dbatools is a module, written by the community, that makes SQL Server administration much easier using PowerShell. Today, the module has more than 260 commands.","url":"https:\/\/claudioessilva.eu\/2017\/09\/07\/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes\/","keywords":"[]"}</script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo 0.126.1 with theme Tranquilpeak 0.5.3-BETA"><meta name=author content="Cláudio Silva"><meta name=keywords content><meta name=description content="I was using open source PowerShell module dbatools ( GitHub repository ) to get the list of SQL Server services I have on a bunch of hosts so I could confirm if they are in &ldquo;running&rdquo; state.
&ndash; Quick note &ndash; For those who don’t know, dbatools is a module, written by the community, that makes SQL Server administration much easier using PowerShell. Today, the module has more than 260 commands."><meta property="og:description" content="I was using open source PowerShell module dbatools ( GitHub repository ) to get the list of SQL Server services I have on a bunch of hosts so I could confirm if they are in &ldquo;running&rdquo; state.
&ndash; Quick note &ndash; For those who don’t know, dbatools is a module, written by the community, that makes SQL Server administration much easier using PowerShell. Today, the module has more than 260 commands."><meta property="og:type" content="article"><meta property="og:title" content="'Invalid class [0x80041010]' error when trying to access SQLServer's WMI classes"><meta name=twitter:title content="'Invalid class [0x80041010]' error when trying to access SQLServer's WMI classes"><meta property="og:url" content="https://claudioessilva.eu/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/"><meta property="twitter:url" content="https://claudioessilva.eu/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/"><meta property="og:site_name" content="Cláudio Silva's Blog"><meta property="og:description" content="I was using open source PowerShell module dbatools ( GitHub repository ) to get the list of SQL Server services I have on a bunch of hosts so I could confirm if they are in &ldquo;running&rdquo; state.
&ndash; Quick note &ndash; For those who don’t know, dbatools is a module, written by the community, that makes SQL Server administration much easier using PowerShell. Today, the module has more than 260 commands."><meta name=twitter:description content="I was using open source PowerShell module dbatools ( GitHub repository ) to get the list of SQL Server services I have on a bunch of hosts so I could confirm if they are in &ldquo;running&rdquo; state.
&ndash; Quick note &ndash; For those who don’t know, dbatools is a module, written by the community, that makes SQL Server administration much easier using PowerShell. Today, the module has more than 260 commands."><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2017-09-07T00:00:00"><meta property="article:modified_time" content="2017-09-07T00:00:00"><meta property="article:tag" content="CIM"><meta property="article:tag" content="dbatools"><meta property="article:tag" content="Different Domains"><meta property="article:tag" content="Monitoring"><meta property="article:tag" content="PowerShell"><meta property="article:tag" content="Remoting"><meta property="article:tag" content="SQLServer"><meta property="article:tag" content="syndicated"><meta property="article:tag" content="WMI"><meta name=twitter:card content="summary"><meta name=twitter:site content="@claudioessilva"><meta name=twitter:creator content="@claudioessilva"><meta property="og:image" content="https://claudioessilva.eu/img/avatar.jpg"><meta property="twitter:image" content="https://claudioessilva.eu/img/avatar.jpg"><title>'Invalid class [0x80041010]' error when trying to access SQLServer's WMI classes</title>
<link rel=icon href=https://claudioessilva.eu/img/favicon.jpg><link rel=canonical href=https://claudioessilva.eu/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://claudioessilva.eu/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css></head><body><div id=blog><header id=header data-behavior=4><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=/ aria-label="Go to homepage">Cláudio Silva's Blog</a></div><a class=header-right-picture href=/#about aria-label="Open the link: /#about"><img class=header-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"></a></header><nav id=sidebar data-behavior=4><div class=sidebar-container><div class=sidebar-profile><a href=/#about aria-label="Read more about the author"><img class=sidebar-profile-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"></a><h4 class=sidebar-profile-name>Cláudio Silva</h4><h5 class=sidebar-profile-bio>Data Platform Architect and PowerShell lover.</h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/ title=Home><i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden=true></i>
<span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/tags title=Tags><i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden=true></i>
<span class=sidebar-button-desc>Tags</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/#about title=About><i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden=true></i>
<span class=sidebar-button-desc>About</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/claudioessilva target=_blank rel=noopener title=GitHub><i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden=true></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://twitter.com/claudioessilva target=_blank rel=noopener title=Twitter><i class="sidebar-button-icon fab fa-lg fa-twitter" aria-hidden=true></i>
<span class=sidebar-button-desc>Twitter</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.linkedin.com/in/claudioessilva target=_blank rel=noopener title=LinkedIn><i class="sidebar-button-icon fab fa-lg fa-linkedin" aria-hidden=true></i>
<span class=sidebar-button-desc>LinkedIn</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/index.xml title=RSS><i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden=true></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul></div><div class=sidebar-container><div style=color:#ebebeb;font-size:25px;text-align:center>dbatools book</div><div style=color:#ebebeb;font-size:15px>Now available! Buy it at manning.com - 50% off with code bldbatools50</div><a href="https://www.manning.com/books/learn-dbatools-in-a-month-of-lunches?utm_source=claudioessilva&utm_medium=affiliate&utm_campaign=affiliate&a_aid=claudioessilva" target=_blank><center><img src=https://images.manning.com/264/352/resize/book/0/998b76f-982a-4661-a020-5d94909f7ea5/LeMaire-HI.png height=300></center></a></div></nav><div id=main data-behavior=4 class=hasCoverMetaIn><article class=post id=top><div class="post-header main-content-wrap text-left"><h1 class=post-title>'Invalid class [0x80041010]' error when trying to access SQLServer's WMI classes</h1><div class="postShorten-meta post-meta"><time datetime=2017-09-07T00:00:00Z>September 7, 2017</time></div></div><div class="post-content markdown"><div class=main-content-wrap><p>I was using open source PowerShell module <a href=http://dbatools.io target=_blank rel="noopener noreferrer">dbatools
</a>(<a href=https://github.com/sqlcollaborative/dbatools target=_blank rel="noopener noreferrer">
GitHub repository
</a>) to get the list of SQL Server services I have on a bunch of hosts so I could confirm if they are in &ldquo;<em>running</em>&rdquo; state.</p><p>&ndash; Quick note &ndash;
For those who don’t know, dbatools is a module, written by the community, that makes SQL Server administration much easier using PowerShell. Today, the module has more than 260 commands. Go get it and try it! If you have any doubt you can join the team on the #dbatools channel at the <a href=http://dbatools.io/slack target=_blank rel="noopener noreferrer">Slack - SQL Server Community
</a>.
&ndash; Quick note &ndash;</p><p>To accomplish this, I&rsquo;m using the <a href=https://dbatools.io/functions/get-dbasqlservice/ target=_blank rel="noopener noreferrer">Get-DbaSqlService
</a>initially written by Klaas Vandenberghe (<a href=https://powerdba.eu/ target=_blank rel="noopener noreferrer">
b
</a>).</p><p>This command is very handy, as it will try different ways to connect to the host and we don&rsquo;t need to do anything extra. Also, it has a <code>-Credential</code> parameter so we can use it to connect to hosts in different domains (I have 10 different credentials, one per domain).</p><h2 id=everything-was-running-fine-for-the-first-couple-of-hosts-until>Everything was running fine, for the first couple of hosts, until&mldr;</h2><p>I got the following message when running on a specific host:</p><blockquote><p>WARNING: Get-DbaSqlService - No ComputerManagement Namespace on HOST001. Please note that this function is available from SQL 2005 up.</p></blockquote><p><img src=/img/2017/09/warning_get-dbasqlservice_2005.png alt=warning_get-dbasqlservice_2005></p><p>Trying to get more information, I have executed the same command but added the <code>-Verbose</code> switch</p><p>From all the blue lines, I spotted this:</p><blockquote><p>VERBOSE: [Get-DbaCmObject][12:23:31] [HOST001] Retrieving Management Information
VERBOSE: [Get-DbaCmObject][12:23:31] [HOST001] Accessing computer using Cim over WinRM
VERBOSE: [Get-DbaCmObject][12:23:47] [HOST001] <strong>Accessing computer using Cim over WinRM - Failed!</strong>
VERBOSE: [Get-DbaCmObject][12:23:47] [HOST001] Accessing computer using Cim over DCOM
VERBOSE: [Get-DbaCmObject][12:23:48] [HOST001] <strong>Accessing computer using Cim over DCOM - Success!</strong></p></blockquote><p>Ok, this means that for this specific host I can&rsquo;t connect via WinRM (using WSMan) but I can when using the DCOM protocol. However,  the WMI query used to get the list of SQL services fails.</p><h3 id=going-further>Going further</h3><p>I open the <a href=https://github.com/sqlcollaborative/dbatools/blob/master/functions/Get-DbaSqlService.ps1 target=_blank rel="noopener noreferrer">Get-DbaSqlService.ps1
</a>script and spotted where the warning message comes from. Then, I have copied the code to a new window in order to isolate it and do another execution tests.</p><p>The code is:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$sessionoption = New-CimSessionOption -Protocol DCOM
</span></span><span style=display:flex><span>$CIMsession = New-CimSession -ComputerName $Computer -SessionOption $sessionoption -ErrorAction SilentlyContinue -Credential $Credential
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#I have skipped an if ( $CIMSession ) that is here because we know that works.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$namespace = Get-CimInstance -CimSession $CIMsession -NameSpace root\Microsoft\SQLServer -ClassName <span style=color:#e6db74>&#34;__NAMESPACE&#34;</span> -Filter <span style=color:#e6db74>&#34;Name Like &#39;ComputerManagement%&#39;&#34;</span> -ErrorAction SilentlyContinue |Where-Object {(Get-CimInstance -CimSession $CIMsession -Namespace $(<span style=color:#e6db74>&#34;root\Microsoft\SQLServer\&#34;</span> + $_.Name) -Query <span style=color:#e6db74>&#34;SELECT * FROM SqlService&#34;</span> -ErrorAction SilentlyContinue).count <span style=color:#f92672>-gt</span> <span style=color:#ae81ff>0</span>}
</span></span></code></pre></div><p>I splitted the last command to remove the pipeline since I would like to analyze each part of the code. I ended with the following code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$sessionoption = New-CimSessionOption -Protocol DCOM
</span></span><span style=display:flex><span>$CIMsession = New-CimSession -ComputerName <span style=color:#e6db74>&#34;HOST001&#34;</span> -SessionOption $sessionoption -ErrorAction <span style=color:#66d9ef>Continue</span> -Credential $Credentials -Verbose
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Get-CimInstance -CimSession $CIMsession -NameSpace root\Microsoft\SQLServer -Query <span style=color:#e6db74>&#34;Select * FROM __NAMESPACE WHERE Name Like &#39;ComputerManagement%&#39;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#This one is comment for now</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Get-CimInstance -CimSession $CIMsession -Namespace $(&#34;root\Microsoft\SQLServer\ComputerManagement10&#34;) -Query &#34;SELECT * FROM SqlService&#34;</span>
</span></span></code></pre></div><p><img src="/img/2017/09/output_select__namespace_computermanagement1.png?w=656" alt=output_select__namespace_computermanagement1></p><p>This can return more than one line with different ComputerManagement (like ComputerManagement10). It depends on the versions you have installed on the host. The number &ldquo;10&rdquo; refers to the SQL Server 2008.
Now I can uncomment the last command and run it. The result is:</p><blockquote><p>Get-CimInstance : <strong>Invalid class</strong>
At line:1 char:1
+ Get-CimInstance -CimSession $CIMsession -Namespace $(&ldquo;root\Microsoft\SQLServer\C &mldr;<br>+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>+ CategoryInfo : MetadataError: (:) [Get-CimInstance], CimException<br>+ FullyQualifiedErrorId : HRESULT 0x80041010,Microsoft.Management.Infrastructure.CimCmdlets.GetCimInstanceCommand<br>+ PSComputerName : HOST001</p></blockquote><p>Ok, a different error message. Let&rsquo;s dig in it. I logged in on the host and confirmed that I have a SQL Server 2008 R2 instance installed. This means that I&rsquo;m not accessing a lower version than 2005 like the initial warning message was suggesting.</p><p>I tried to execute locally the same query but this time using <code>Get-WmiObject</code> instead of <code>Get-CimInstance</code> (which, in this case wasn&rsquo;t available because the host only have PowerShell v2.0. It&rsquo;s a Windows server 2008 SP2. CIM cmdlets appears on v3.0) and it failed with the same error.</p><blockquote><p>Get-WmiObject : <strong>Invalid class</strong>
At line:1 char:5
+ gwmi &lt;&lt;&lt;&lt; -Namespace &ldquo;root\Microsoft\SQLServer\ComputerManagement10&rdquo; -Query &ldquo;SELECT * FROM SqlService&rdquo;<br>+ CategoryInfo : InvalidOperation: (:) [Get-WmiObject], ManagementException<br>+ FullyQualifiedErrorId : GetWMIManagementException,Microsoft.PowerShell.Commands.GetWmiObjectCommand</p></blockquote><p>I remembered, from past experiences, that SQL Server Configuration manager relies on WMI classes to show the information, so I tried to open it and I got the following error message:
<a href=https://claudioessilva.github.io/img/2017/09/sqlserverconfigurationmanager_invalidclass_error.png target=_blank rel="noopener noreferrer">sqlserverconfigurationmanager_invalidclass_error</a></p><blockquote><p>Cannot connect to WMI provider. You do not have permission or the server in unreachable. Note that you can only manage SQL Server 2005 and later servers with SQL Server Configuration Manager.
<strong>Invalid class [0x80041010]</strong></p></blockquote><p>Again, that 2005 callout, but&mldr;did you recognize the last sentence? It&rsquo;s the same error I was getting with Get-CIMInstance remotely and Get-WmiObject locally.</p><p>Definitely something is broken.</p><h2 id=lets-fix-it>&ldquo;Let&rsquo;s fix it!&rdquo;</h2><p>To fix this problem we need to reinstall the SQL Server WMI provider. To do this we need to run 2 commands. (I found this in <a href=http://www.chongchonggou.com/g_852406064.html target=_blank rel="noopener noreferrer">this post
</a>)</p><ul><li><p>Install classes:
Go to <em>C:\Program Files (x86)\Microsoft SQL Server{Version 110 is SQL2012}\Shared</em>
There you can find a file with <em>mof</em> extension. The file name <em>sqlmgmproviderxpsp2up.mof</em>
Now on the command line run the following command:
<strong>mofcomp sqlmgmproviderxpsp2up.mof</strong>
The output:
<img src=/img/2017/09/output_mofcomp_mof.png alt=output_mofcomp_mof></p></li><li><p>Install localization info:
Navigate to the Shared sub-folder that indicates the locale of your SQL Server installation. In my case is the 1033 (english-US).
Inside that folder you will find a file with the <em>.mfl</em> extension. The file name is <em>sqlmgmprovider.mfl.</em> On the command line run the following command:
<strong>mofcomp sqlmgmprovider.mfl</strong>
The output:
<img src=/img/2017/09/output_mofcomp_mfl.png alt=output_mofcomp_mfl></p></li></ul><p>With these 2 actions, we are done.</p><p>Now we can try to open the SQL Server Configuration Manager again and it opens like expected! Without error messages.</p><p>Let&rsquo;s go back and rerun our commands.
On the host:
<img src="/img/2017/09/output_gwmi_locally_ok.png?w=656" alt=output_gwmi_locally_ok></p><p>Remotely:
<img src="/img/2017/09/output_getciminstance_remotely_ok.png?w=656" alt=output_getciminstance_remotely_ok></p><p>And from dbatools Get-DbaSqlService command:
<img src="/img/2017/09/output_get-dbasqlservice_ok.png?w=656" alt=output_get-dbasqlservice_ok></p><p>No more &ldquo;invalid class&rdquo; messages and we get the output we want!</p><p>Thanks for reading.</p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">TAGGED IN</span><br><a class="tag tag--primary tag--small" href=/tags/CIM/>CIM</a>
<a class="tag tag--primary tag--small" href=/tags/dbatools/>dbatools</a>
<a class="tag tag--primary tag--small" href=/tags/Different-Domains/>Different Domains</a>
<a class="tag tag--primary tag--small" href=/tags/Monitoring/>Monitoring</a>
<a class="tag tag--primary tag--small" href=/tags/PowerShell/>PowerShell</a>
<a class="tag tag--primary tag--small" href=/tags/Remoting/>Remoting</a>
<a class="tag tag--primary tag--small" href=/tags/SQLServer/>SQLServer</a>
<a class="tag tag--primary tag--small" href=/tags/syndicated/>syndicated</a>
<a class="tag tag--primary tag--small" href=/tags/WMI/>WMI</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/ data-tooltip="Someone is not following the best practices - dbatools and Pester don't lie!" aria-label="NEXT: Someone is not following the best practices - dbatools and Pester don't lie!"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/09/04/HTTP-403-error-PowerShell-Remoting-Different-Domains-and-Proxies/ data-tooltip="HTTP 403 error - PowerShell Remoting, Different Domains and Proxies" aria-label="PREVIOUS: HTTP 403 error - PowerShell Remoting, Different Domains and Proxies"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://claudioessilva.eu/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://claudioessilva.eu/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://claudioessilva.eu/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div><div class=comments><script src=https://utteranc.es/client.js repo=ClaudioESSilva/blog-comments issue-term=og:title theme=github-light crossorigin=anonymous async></script></div></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2024 Cláudio Silva. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=4><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/ data-tooltip="Someone is not following the best practices - dbatools and Pester don't lie!" aria-label="NEXT: Someone is not following the best practices - dbatools and Pester don't lie!"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/09/04/HTTP-403-error-PowerShell-Remoting-Different-Domains-and-Proxies/ data-tooltip="HTTP 403 error - PowerShell Remoting, Different Domains and Proxies" aria-label="PREVIOUS: HTTP 403 error - PowerShell Remoting, Different Domains and Proxies"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://claudioessilva.eu/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://claudioessilva.eu/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://claudioessilva.eu/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=4><i id=btn-close-shareoptions class="fa fa-times"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fclaudioessilva.eu%2F2017%2F09%2F07%2FInvalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes%2F" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i><span>Share on Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fclaudioessilva.eu%2F2017%2F09%2F07%2FInvalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes%2F" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i><span>Share on Twitter</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fclaudioessilva.eu%2F2017%2F09%2F07%2FInvalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes%2F" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i><span>Share on Linkedin</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-times"></i></div><img id=about-card-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"><h4 id=about-card-name>Cláudio Silva</h4><div id=about-card-bio>Data Platform Architect and PowerShell lover.</div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Data Platform Architect</div><div id=about-card-location><i class="fa fa-map-marker-alt"></i><br>Portugal</div></div></div><div id=cover style=background-image:url(https://claudioessilva.eu/images/cover_bridge.jpg)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://claudioessilva.eu/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js></script><script>$(document).ready(function(){hljs.configure({classPrefix:"",useBR:!1}),$("pre.code-highlight > code, pre > code").each(function(e,t){$(this).hasClass("codeblock")||$(this).addClass("codeblock"),hljs.highlightBlock(t)})})</script></body></html>