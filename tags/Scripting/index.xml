<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Scripting on ClÃ¡udio Silva's Blog</title><link>https://claudioessilva.eu/tags/Scripting/</link><description>Recent content in Scripting on ClÃ¡udio Silva's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 22 Sep 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://claudioessilva.eu/tags/Scripting/index.xml" rel="self" type="application/rss+xml"/><item><title>Recover database encrypted modules code with dbatools</title><link>https://claudioessilva.eu/2020/09/22/Recover-database-encrypted-modules-code-with-dbatools/</link><pubDate>Tue, 22 Sep 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/09/22/Recover-database-encrypted-modules-code-with-dbatools/</guid><description>This article was initially posted on SQLServerCentral @ 2020-08-18. It was interesting some comments I read about it, mainly why people still use WITH ENCRYPTION when it&amp;rsquo;s simple to overcome this when we have the right permissions.
SQL Server offers an option to encrypt the code of your modules when using the WITH ENCRYPTION syntax. This allows to hide/obfuscate the modules&amp;rsquo; code and thus keep away from prying eyes. It&amp;rsquo;s often used to protect business rules since it allows you to protect some intellectual property.</description></item><item><title>Generate SQL Server Role Member Reports using dbatools and ImportExcel PowerShell modules</title><link>https://claudioessilva.eu/2020/07/31/Generate-SQL-Server-Role-Member-Reports-using-dbatools-and-ImportExcel-PowerShell-modules/</link><pubDate>Fri, 31 Jul 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/07/31/Generate-SQL-Server-Role-Member-Reports-using-dbatools-and-ImportExcel-PowerShell-modules/</guid><description>This was initial posted on SQL Server Central articles .
As one of dbatools&amp;rsquo; first members, I&amp;rsquo;ve been using it for years and it&amp;rsquo;s really my goto tool. This task was no different!
Today&amp;rsquo;s tip and trick using dbatools is about generating an Excel workbook that contains lists of SQL Server roles and its members.
The Usefulness of these Reports These reports are especially useful when performing tech-refreshes (migrating from an old version to a newer one) and you want to do some housekeeping.</description></item><item><title>Backup your SQL instances configurations to GIT with dbatools - Part 2 - Add parallelism</title><link>https://claudioessilva.eu/2020/06/04/Backup-your-SQL-instances-configurations-to-GIT-with-dbatools-Part-2-Add-parallelism/</link><pubDate>Thu, 04 Jun 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/06/04/Backup-your-SQL-instances-configurations-to-GIT-with-dbatools-Part-2-Add-parallelism/</guid><description>We have seen how we can export and save the results to a folder and commit them to a GIT repository on my last blog post Backup your SQL instances configurations to GIT with dbatools â€“ Part 1 . At the end of that post, I have mentioned that I would write about how we can lower down the execution times of our script by leveraging on parallelism.
Going parallel When we need to manage dozens of servers/instances, even with automated scripts sometimes we would like that our script finishes faster.</description></item><item><title>Backup your SQL instances configurations to GIT with dbatools - Part 1</title><link>https://claudioessilva.eu/2020/06/02/Backup-your-SQL-instances-configurations-to-GIT-with-dbatools-Part-1/</link><pubDate>Tue, 02 Jun 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/06/02/Backup-your-SQL-instances-configurations-to-GIT-with-dbatools-Part-1/</guid><description>Today I want to share how I&amp;rsquo;m keeping a copy of instances&amp;rsquo; configurations using dbatools .
Chrissy LeMaire ( B | T ) wrote about it before on the Simplifying disaster recovery with dbatools blog post. In this post, I will add one step and save the output on a GIT repository.
Pre-requirements You need a GIT repository GIT tools installed on the server where you are running the script so you can commit your changes dbatools A list or a place to get all instances that you want to run the export Preparation Git repository Clone your repository to a location where dbatools can write to.</description></item><item><title>Replicate permissions to new Login/User with dbatools</title><link>https://claudioessilva.eu/2020/05/28/Replicate-permissions-to-new-Login/User-with-dbatools/</link><pubDate>Thu, 28 May 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/05/28/Replicate-permissions-to-new-Login/User-with-dbatools/</guid><description>Continuing to share tips and tricks using dbatools like the Refresh databases that belongs to availability group using dbatools posted a few days ago, today I will share a way to export the permissions of a login/user at instance/database level and apply them to a new login/user.
The typical request Client: &amp;ldquo;We have a new colleague, can you please grant them the exact same permissions I have?!&amp;rdquo;
A quick note/suggestion that may help minimize your work: If we are talking about a Windows Login, please suggest the use of AD groups to help you (so that you don&amp;rsquo;t need to do this process) and also them (they don&amp;rsquo;t need to make this request).</description></item><item><title>Export Deadlocks to file from system_health Extended Event using PowerShell</title><link>https://claudioessilva.eu/2020/05/25/Export-Deadlocks-to-file-from-system_health-Extended-Event-using-PowerShell/</link><pubDate>Mon, 25 May 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/05/25/Export-Deadlocks-to-file-from-system_health-Extended-Event-using-PowerShell/</guid><description>Just a quick post as may help any of you searching for this.
Scenario Client wants to analyze most recent deadlocks that happened on a specific instance. They asked us to send the xdl files.
How do we get the deadlocks? Depending on the version of SQL Server that you are running, there are different ways to do it. In this post I will share how you can do it from all files that belongs to the system_health extended event session.</description></item><item><title>Refresh databases that belongs to Availability Group using dbatools</title><link>https://claudioessilva.eu/2020/05/20/Refresh-databases-that-belongs-to-Availability-Group-using-dbatools/</link><pubDate>Wed, 20 May 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/05/20/Refresh-databases-that-belongs-to-Availability-Group-using-dbatools/</guid><description>Few days ago I was surfing on Twitter when dbatools asked about how it&amp;rsquo;s PowerShell module changed the way people work .
Open and check the answers given by the community as there is really good stuff there!
My turn I have shared one of my recipes related to database refreshes. You know, when the client says, &amp;ldquo;please restore this backup or the most recent backup on our instance.&amp;rdquo;. But what if the databases belong to an availability group?</description></item><item><title>T-SQL Copy &amp; Paste Pattern - Increasing a performance problem</title><link>https://claudioessilva.eu/2020/02/21/T-SQL-Copy-Paste-Pattern-Increasing-a-performance-problem/</link><pubDate>Fri, 21 Feb 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/02/21/T-SQL-Copy-Paste-Pattern-Increasing-a-performance-problem/</guid><description>Disclaimer: The title is my assumption because I saw it in the past happening this way.
This blog post aims to make you remember something: something that is obvious to you, might not be obvious to others.
Scenario A client has a process which consists of a stored procedure that wraps a bunch of other stored procedures. The process runs for about 10 hours.
Taking a look&amp;hellip;what is running right now?</description></item><item><title>Change Outlook sender mailbox with PowerShell - A workaround</title><link>https://claudioessilva.eu/2020/02/12/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround/</link><pubDate>Wed, 12 Feb 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/02/12/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround/</guid><description>The idea of this blog post, like many others I write, is to document a workaround solution to my problem. Hopefully I can also help someone that may be looking for the solution for this problem and stumbles accidentally (or not) on my blog.
Scenario I was helping a colleague automating the creation of emails using Microsoft Outlook using PowerShell. The following are configurable options (these will be the parameters of the script):</description></item><item><title>Allow SQL Server Agent jobs management for non sysadmins</title><link>https://claudioessilva.eu/2019/08/13/Allow-SQL-Server-Agent-jobs-management-for-non-sysadmins/</link><pubDate>Tue, 13 Aug 2019 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2019/08/13/Allow-SQL-Server-Agent-jobs-management-for-non-sysadmins/</guid><description>I don&amp;rsquo;t know about your experience when it comes to SQL Server Agent jobs but often I receive requests to grant permission so that clients can handle their jobs in an autonomous way.
Any problem with that? It depends ðŸ˜„ If you&amp;rsquo;re not familiarized with the difficulty this can bring, let me share with you a different way to accomplish the task without adding the login to the sysadmin instance role.</description></item><item><title>'Ups...I have deleted some data. Can you put it back?' - dbatools for the rescue</title><link>https://claudioessilva.eu/2019/05/17/Ups...I-have-deleted-some-data.-Can-you-put-it-back-dbatools-for-the-rescue/</link><pubDate>Fri, 17 May 2019 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2019/05/17/Ups...I-have-deleted-some-data.-Can-you-put-it-back-dbatools-for-the-rescue/</guid><description>Few days ago I received a request to restore a dozen of tables because someone have deleted more data than it was supposed. I immediately thought about dbatools for the job!
NOTE: I also thought about SSMS &amp;ldquo;Import/Export Data&amp;rdquo;. And this is ok when someone says &amp;ldquo;it&amp;rsquo;s to run just once, just now&amp;rdquo;. When you are in the IT for a while you know that is not only once :-). And what if I need to re-run?</description></item><item><title>Scripting SQL Server objects with dbatools - Beyond default options</title><link>https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/</link><pubDate>Wed, 15 May 2019 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/</guid><description>Probably you had the need to script out some objects from a SQL Server instance/database and this is quite easy. You just need to right click on the object (well&amp;hellip;not on every single one, try it with an Availability Group :-), no script option available) select &amp;ldquo;Script XXXX as&amp;rdquo; and you have it.
But have you realized that this option doesn&amp;rsquo;t bring all the stuff? Let&amp;rsquo;s say you are scripting a table and you have a Non-Clustered index or a trigger&amp;hellip;using this option some of the objects under the table will not be scripted out.</description></item><item><title>Is this command broken? I can't see some properties! - DefaultDisplayPropertySet, Get-Member and Select-Object *</title><link>https://claudioessilva.eu/2018/04/23/Is-this-command-broken-I-cant-see-some-properties-DefaultDisplayPropertySet-Get-Member-and-Select-Object/</link><pubDate>Mon, 23 Apr 2018 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2018/04/23/Is-this-command-broken-I-cant-see-some-properties-DefaultDisplayPropertySet-Get-Member-and-Select-Object/</guid><description>Every now and again I see some people complaining about not getting the properties they want when using a PowerShell command.
For instance, someone was using the Get-Service command to query what was the &amp;ldquo;Startup Type&amp;rdquo; of WinRM service . For that the person used the following command:
Get-Service WinRM which produces the following output: As you can see, the &amp;ldquo;Startup Type&amp;rdquo; property that we can find on the user interface does not appear here!</description></item><item><title>[PowerShell] From 20 minutes to 20 seconds - Change domain user password on multiple domains without login into each one</title><link>https://claudioessilva.eu/2017/09/14/PowerShell-From-20-minutes-to-20-seconds-Change-domain-user-password-on-multiple-domains-without-login-into-each-one/</link><pubDate>Thu, 14 Sep 2017 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2017/09/14/PowerShell-From-20-minutes-to-20-seconds-Change-domain-user-password-on-multiple-domains-without-login-into-each-one/</guid><description>I&amp;rsquo;m working on a environment where I have to deal with multiple domains. The user&amp;rsquo;s password needs to be updated each 40/45 days (it depends on the domain).
Can you see the pain? This means that every month and half I have to dedicate like 20 minutes to change my password on 10 different domains by logging in to a host that belongs to that domain to be able to change it.</description></item></channel></rss>