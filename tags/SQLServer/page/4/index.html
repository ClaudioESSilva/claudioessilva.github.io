<!doctype html><html lang=en-us><head><script type=application/ld+json>{"@context":"http://schema.org","@type":"Website","@id":"https:\/\/claudioessilva.eu\/","author":{"@type":"Person","name":null},"name":"Cláudio Silva\u0027s Blog","description":"Cláudios\u0027 Blog","url":"https:\/\/claudioessilva.eu\/tags\/SQLServer\/","keywords":"[]"}</script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo 0.145.0 with theme Tranquilpeak 0.5.3-BETA"><meta name=author content><meta name=keywords content><meta name=description content="Cláudios' Blog"><meta property="og:description" content="Cláudios' Blog"><meta property="og:type" content="website"><meta property="og:title" content="SQLServer"><meta name=twitter:title content="SQLServer"><meta property="og:url" content="https://claudioessilva.eu/tags/SQLServer/"><meta property="twitter:url" content="https://claudioessilva.eu/tags/SQLServer/"><meta property="og:site_name" content="Cláudio Silva's Blog"><meta property="og:description" content="Cláudios' Blog"><meta name=twitter:description content="Cláudios' Blog"><meta property="og:locale" content="en-us"><meta name=twitter:card content="summary"><title>SQLServer</title>
<link rel=icon href=https://claudioessilva.eu/img/favicon.jpg><link rel=alternate type=application/rss+xml title=RSS href=/tags/SQLServer/index.xml><link rel=canonical href=https://claudioessilva.eu/tags/SQLServer/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://claudioessilva.eu/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-55EWW6EWZM"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-55EWW6EWZM")}</script></head><body><div id=blog><header id=header data-behavior=1><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=/ aria-label="Go to homepage">Cláudio Silva's Blog</a></div><a class=header-right-picture href=/#about aria-label="Open the link: /#about"></a></header><nav id=sidebar data-behavior=1><div class=sidebar-container><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/ title=Home><i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden=true></i>
<span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/tags title=Tags><i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden=true></i>
<span class=sidebar-button-desc>Tags</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/#about title=About><i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden=true></i>
<span class=sidebar-button-desc>About</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/claudioessilva target=_blank rel=noopener title=GitHub><i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden=true></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://twitter.com/claudioessilva target=_blank rel=noopener title=Twitter><i class="sidebar-button-icon fab fa-lg fa-twitter" aria-hidden=true></i>
<span class=sidebar-button-desc>Twitter</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.linkedin.com/in/claudioessilva target=_blank rel=noopener title=LinkedIn><i class="sidebar-button-icon fab fa-lg fa-linkedin" aria-hidden=true></i>
<span class=sidebar-button-desc>LinkedIn</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/index.xml title=RSS><i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden=true></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul></div><div class=sidebar-container><div style=color:#ebebeb;font-size:25px;text-align:center>dbatools book</div><div style=color:#ebebeb;font-size:15px>Now available! Buy it at manning.com - 50% off with code bldbatools50</div><a href="https://www.manning.com/books/learn-dbatools-in-a-month-of-lunches?utm_source=claudioessilva&utm_medium=affiliate&utm_campaign=affiliate&a_aid=claudioessilva" target=_blank><center><img src=https://images.manning.com/264/352/resize/book/0/998b76f-982a-4661-a020-5d94909f7ea5/LeMaire-HI.png height=300></center></a></div></nav><div id=main data-behavior=1 class=hasCoverMetaIn><section class="postShorten-group main-content-wrap"><article class="postShorten postShorten--thumbnailimg-top"><div class=postShorten-wrap><div class=postShorten-header><h1 class=postShorten-title><a class=link-unstyled href=https://claudioessilva.eu/2020/05/25/Export-Deadlocks-to-file-from-system_health-Extended-Event-using-PowerShell/ aria-label="Open the post: Export Deadlocks to file from system_health Extended Event using PowerShell">Export Deadlocks to file from system_health Extended Event using PowerShell</a></h1><div class="postShorten-meta post-meta"><time datetime=2020-05-25T00:00:00Z>May 25, 2020</time></div></div><div class=postShorten-excerpt><p>Just a quick post as may help any of you searching for this.</p><h2 id=scenario>Scenario</h2><p>Client wants to analyze most recent deadlocks that happened on a specific instance. They asked us to send the xdl files.</p><h2 id=how-do-we-get-the-deadlocks>How do we get the deadlocks?</h2><p>Depending on the version of SQL Server that you are running, there are different ways to do it.
In this post I will share how you can do it from all files that belongs to the <code>system_health</code> extended event session. (Not only the current file).
This works on SQL Server 2012 or higher version.
For a better overview I recommend you to read the <a href=https://www.sqlshack.com/what-are-sql-server-deadlocks-and-how-to-monitor-them/ target=_blank rel="noopener noreferrer">What are SQL Server deadlocks and how to monitor them
</a>article from SQLShack.</p><p><a href=https://claudioessilva.eu/2020/05/25/Export-Deadlocks-to-file-from-system_health-Extended-Event-using-PowerShell/ class="postShorten-excerpt_link link" aria-label="Open the post: Export Deadlocks to file from system_health Extended Event using PowerShell">Continue reading</a></p></div></div></article><article class="postShorten postShorten--thumbnailimg-top"><div class=postShorten-wrap><div class=postShorten-header><h1 class=postShorten-title><a class=link-unstyled href=https://claudioessilva.eu/2020/05/20/Refresh-databases-that-belongs-to-Availability-Group-using-dbatools/ aria-label="Open the post: Refresh databases that belongs to Availability Group using dbatools">Refresh databases that belongs to Availability Group using dbatools</a></h1><div class="postShorten-meta post-meta"><time datetime=2020-05-20T00:00:00Z>May 20, 2020</time></div></div><div class=postShorten-excerpt><p>Few days ago I was surfing on Twitter when <a href=https://twitter.com/psdbatools target=_blank rel="noopener noreferrer">dbatools
</a>asked about <a href=https://twitter.com/psdbatools/status/1261563168113012736 target=_blank rel="noopener noreferrer">how it&rsquo;s PowerShell module changed the way people work
</a>.</p><p>Open and check the answers given by the community as there is really good stuff there!</p><h2 id=my-turn>My turn</h2><p>I have shared one of my recipes related to database refreshes. You know, when the client says, &ldquo;please restore this backup or the most recent backup on our instance.&rdquo;. But what if the databases belong to an availability group? It&rsquo;s not as simple as a standalone installation.</p><p><a href=https://claudioessilva.eu/2020/05/20/Refresh-databases-that-belongs-to-Availability-Group-using-dbatools/ class="postShorten-excerpt_link link" aria-label="Open the post: Refresh databases that belongs to Availability Group using dbatools">Continue reading</a></p></div></div></article><article class="postShorten postShorten--thumbnailimg-top"><div class=postShorten-wrap><div class=postShorten-header><h1 class=postShorten-title><a class=link-unstyled href=https://claudioessilva.eu/2020/02/21/T-SQL-Copy-Paste-Pattern-Increasing-a-performance-problem/ aria-label="Open the post: T-SQL Copy & Paste Pattern - Increasing a performance problem">T-SQL Copy & Paste Pattern - Increasing a performance problem</a></h1><div class="postShorten-meta post-meta"><time datetime=2020-02-21T00:00:00Z>February 21, 2020</time></div></div><div class=postShorten-excerpt><p>Disclaimer: The title is my assumption because I saw it in the past happening this way.</p><p>This blog post aims to make you remember something: something that is obvious to you, might not be obvious to others.</p><h2 id=scenario>Scenario</h2><p>A client has a process which consists of a stored procedure that wraps a bunch of other stored procedures.
The process runs for about 10 hours.</p><h2 id=taking-a-lookwhat-is-running-right-now>Taking a look&mldr;what is running right now?</h2><p>I was curious about the process, I&rsquo;ve seen this running before but never explored the code. After a couple of days of seeing it running for so long, I decided to see what would be the random query I would get executing.</p><p><a href=https://claudioessilva.eu/2020/02/21/T-SQL-Copy-Paste-Pattern-Increasing-a-performance-problem/ class="postShorten-excerpt_link link" aria-label="Open the post: T-SQL Copy & Paste Pattern - Increasing a performance problem">Continue reading</a></p></div></div></article><article class="postShorten postShorten--thumbnailimg-top"><div class=postShorten-wrap><div class=postShorten-header><h1 class=postShorten-title><a class=link-unstyled href=https://claudioessilva.eu/2020/02/04/Temporarily-enable-TLS-1.0/1.1-Be-sure-you-check-this-keys/ aria-label="Open the post: Temporarily enable TLS 1.0/1.1? - Be sure you check this keys">Temporarily enable TLS 1.0/1.1? - Be sure you check this keys</a></h1><div class="postShorten-meta post-meta"><time datetime=2020-02-04T00:00:00Z>February 4, 2020</time></div></div><div class=postShorten-excerpt><p>There are some actions that we know that will have to be repeated from time to time, but the surprise comes when it’s time to do so and the process that used to work does not work anymore.</p><p>This is a short post to document a slight change that I had to do to achieve the same final result as the first time.</p><h2 id=long-story-short>Long story short</h2><p>A client needed to run a setup to install an application. This setup uses a utility called <code>minisql.exe</code> to test database connection. The problem is that this utility only works with TLS 1.0/1.1 and, on our systems, we only have TLS 1.2 enabled.</p><p><a href=https://claudioessilva.eu/2020/02/04/Temporarily-enable-TLS-1.0/1.1-Be-sure-you-check-this-keys/ class="postShorten-excerpt_link link" aria-label="Open the post: Temporarily enable TLS 1.0/1.1? - Be sure you check this keys">Continue reading</a></p></div></div></article><article class="postShorten postShorten--thumbnailimg-top"><div class=postShorten-wrap><div class=postShorten-header><h1 class=postShorten-title><a class=link-unstyled href=https://claudioessilva.eu/2019/08/20/More-PowerShell-Remoting-coverage-in-dbatools/ aria-label="Open the post: More PowerShell Remoting coverage in dbatools">More PowerShell Remoting coverage in dbatools</a></h1><div class="postShorten-meta post-meta"><time datetime=2019-08-20T00:00:00Z>August 20, 2019</time></div></div><div class=postShorten-excerpt><p>Starting on dbatools version 1.0.31 we introduced better coverage for commands that make use of PowerShell Remoting.</p><h2 id=which-commands>Which commands?</h2><p>Commands like <code>Get-DbaComputerCertificate</code>, <code>Get-DbaPrivilege</code>, <code>Get-DbaClientAlias</code>, just to mention a few of them, make use of the internal function <code>Invoke-Command2</code> which uses <code>New-PSSession</code> when we run it against a remote computer.</p><h2 id=why-have-you-changed-it>&ldquo;Why have you changed it?&rdquo;</h2><p>Let me give you a little bit of background&mldr;
At my company, I found that some dbatools commands were not working. They were returning errors related with WinRM configurations, as seen here when attempting to create a new session using <code>New-PSSession</code>:
<img src=/img/2019/08/new-pssession_error.png alt=new-pssession_error></p><p><a href=https://claudioessilva.eu/2019/08/20/More-PowerShell-Remoting-coverage-in-dbatools/ class="postShorten-excerpt_link link" aria-label="Open the post: More PowerShell Remoting coverage in dbatools">Continue reading</a></p></div></div></article><div class=pagination-bar><ul class=pagination><li class=pagination-prev><a class="btn btn--default btn--small" href=/tags/SQLServer/page/3/ aria-label="NEWER POSTS"><i class="fa fa-angle-left text-base icon-mr"></i>
<span>NEWER POSTS</span></a></li><li class=pagination-next><a class="btn btn--default btn--small" href=/tags/SQLServer/page/5/ aria-label="OLDER POSTS"><span>OLDER POSTS</span>
<i class="fa fa-angle-right text-base icon-ml"></i></a></li><li class=pagination-number>page 4 of 11</li></ul></div></section><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2025 Cláudio Silva's Blog. All Rights Reserved</span></footer></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-times"></i></div><h4 id=about-card-name></h4></div></div><div id=cover style=background-image:url(https://claudioessilva.eu/images/cover_bridge.jpg)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://claudioessilva.eu/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js></script><script>$(document).ready(function(){hljs.configure({classPrefix:"",useBR:!1}),$("pre.code-highlight > code, pre > code").each(function(e,t){$(this).hasClass("codeblock")||$(this).addClass("codeblock"),hljs.highlightBlock(t)})})</script></body></html>