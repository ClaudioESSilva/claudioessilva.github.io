<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Dbatools on Cláudio Silva's Blog</title><link>https://claudioessilva.eu/tags/dbatools/</link><description>Recent content in Dbatools on Cláudio Silva's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 07 Jun 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://claudioessilva.eu/tags/dbatools/index.xml" rel="self" type="application/rss+xml"/><item><title>dbatools - Exceptions</title><link>https://claudioessilva.eu/2022/06/07/dbatools-Exceptions/</link><pubDate>Tue, 07 Jun 2022 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2022/06/07/dbatools-Exceptions/</guid><description>Who doesn&amp;rsquo;t like a good red and verbose exception?
At PowerShell community we often call it a &amp;ldquo;sea of red&amp;rdquo; which we found as something that can be intimidating. The bigger the error message the more problematic it is? :-)
We don&amp;rsquo;t think so! That&amp;rsquo;s why we, within dbatools project, try to keep the output of the exceptions more user friendly and try to give the direct error message to you.</description></item><item><title>dbatools - rich datatypes</title><link>https://claudioessilva.eu/2022/06/02/dbatools-rich-datatypes/</link><pubDate>Thu, 02 Jun 2022 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2022/06/02/dbatools-rich-datatypes/</guid><description>Some datatypes can be shown in so many different forms (think measurament units, dates with short/long forms, or regional settings) that can be difficult to have a standard.
What should we show? Sizes should be always in bytes? It will be easier for you to interpret 1610612736 bytes or 1.50 GB?
That&amp;rsquo;s why we have created some rich datatypes like, DbaTime, DbaDate, DbaDatetime, DbaTimeSpan, PrettyTimeSpan or DbaSize to make it easier to read and be more consistent acrross multiple commands.</description></item><item><title>Recover database encrypted modules code with dbatools</title><link>https://claudioessilva.eu/2020/09/22/Recover-database-encrypted-modules-code-with-dbatools/</link><pubDate>Tue, 22 Sep 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/09/22/Recover-database-encrypted-modules-code-with-dbatools/</guid><description>This article was initially posted on SQLServerCentral @ 2020-08-18. It was interesting some comments I read about it, mainly why people still use WITH ENCRYPTION when it&amp;rsquo;s simple to overcome this when we have the right permissions.
SQL Server offers an option to encrypt the code of your modules when using the WITH ENCRYPTION syntax. This allows to hide/obfuscate the modules&amp;rsquo; code and thus keep away from prying eyes. It&amp;rsquo;s often used to protect business rules since it allows you to protect some intellectual property.</description></item><item><title>When one of your DBA colleagues leaves the company, what is your checklist?</title><link>https://claudioessilva.eu/2020/09/03/When-one-of-your-DBA-colleagues-leaves-the-company-what-is-your-checklist/</link><pubDate>Thu, 03 Sep 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/09/03/When-one-of-your-DBA-colleagues-leaves-the-company-what-is-your-checklist/</guid><description>Whether it’s in our personal lives or the professional one, we do have checklists for certain tasks.
On the professional level, it can be purely technical like SQL Server installation, configuration or even uninstall, but they can also be not so technical like when a colleague join the team and someone needs to request permissions to access the company&amp;rsquo;s tools (such as ticketing/incidents/VPN/etc).
What about when a colleague leaves the company?</description></item><item><title>Generate SQL Server Role Member Reports using dbatools and ImportExcel PowerShell modules</title><link>https://claudioessilva.eu/2020/07/31/Generate-SQL-Server-Role-Member-Reports-using-dbatools-and-ImportExcel-PowerShell-modules/</link><pubDate>Fri, 31 Jul 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/07/31/Generate-SQL-Server-Role-Member-Reports-using-dbatools-and-ImportExcel-PowerShell-modules/</guid><description>This was initial posted on SQL Server Central articles .
As one of dbatools&amp;rsquo; first members, I&amp;rsquo;ve been using it for years and it&amp;rsquo;s really my goto tool. This task was no different!
Today&amp;rsquo;s tip and trick using dbatools is about generating an Excel workbook that contains lists of SQL Server roles and its members.
The Usefulness of these Reports These reports are especially useful when performing tech-refreshes (migrating from an old version to a newer one) and you want to do some housekeeping.</description></item><item><title>Backup your SQL instances configurations to GIT with dbatools - Part 2 - Add parallelism</title><link>https://claudioessilva.eu/2020/06/04/Backup-your-SQL-instances-configurations-to-GIT-with-dbatools-Part-2-Add-parallelism/</link><pubDate>Thu, 04 Jun 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/06/04/Backup-your-SQL-instances-configurations-to-GIT-with-dbatools-Part-2-Add-parallelism/</guid><description>We have seen how we can export and save the results to a folder and commit them to a GIT repository on my last blog post Backup your SQL instances configurations to GIT with dbatools – Part 1 . At the end of that post, I have mentioned that I would write about how we can lower down the execution times of our script by leveraging on parallelism.
Going parallel When we need to manage dozens of servers/instances, even with automated scripts sometimes we would like that our script finishes faster.</description></item><item><title>Backup your SQL instances configurations to GIT with dbatools - Part 1</title><link>https://claudioessilva.eu/2020/06/02/Backup-your-SQL-instances-configurations-to-GIT-with-dbatools-Part-1/</link><pubDate>Tue, 02 Jun 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/06/02/Backup-your-SQL-instances-configurations-to-GIT-with-dbatools-Part-1/</guid><description>Today I want to share how I&amp;rsquo;m keeping a copy of instances&amp;rsquo; configurations using dbatools .
Chrissy LeMaire ( B | T ) wrote about it before on the Simplifying disaster recovery with dbatools blog post. In this post, I will add one step and save the output on a GIT repository.
Pre-requirements You need a GIT repository GIT tools installed on the server where you are running the script so you can commit your changes dbatools A list or a place to get all instances that you want to run the export Preparation Git repository Clone your repository to a location where dbatools can write to.</description></item><item><title>Replicate permissions to new Login/User with dbatools</title><link>https://claudioessilva.eu/2020/05/28/Replicate-permissions-to-new-Login/User-with-dbatools/</link><pubDate>Thu, 28 May 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/05/28/Replicate-permissions-to-new-Login/User-with-dbatools/</guid><description>Continuing to share tips and tricks using dbatools like the Refresh databases that belongs to availability group using dbatools posted a few days ago, today I will share a way to export the permissions of a login/user at instance/database level and apply them to a new login/user.
The typical request Client: &amp;ldquo;We have a new colleague, can you please grant them the exact same permissions I have?!&amp;rdquo;
A quick note/suggestion that may help minimize your work: If we are talking about a Windows Login, please suggest the use of AD groups to help you (so that you don&amp;rsquo;t need to do this process) and also them (they don&amp;rsquo;t need to make this request).</description></item><item><title>Export Deadlocks to file from system_health Extended Event using PowerShell</title><link>https://claudioessilva.eu/2020/05/25/Export-Deadlocks-to-file-from-system_health-Extended-Event-using-PowerShell/</link><pubDate>Mon, 25 May 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/05/25/Export-Deadlocks-to-file-from-system_health-Extended-Event-using-PowerShell/</guid><description>Just a quick post as may help any of you searching for this.
Scenario Client wants to analyze most recent deadlocks that happened on a specific instance. They asked us to send the xdl files.
How do we get the deadlocks? Depending on the version of SQL Server that you are running, there are different ways to do it. In this post I will share how you can do it from all files that belongs to the system_health extended event session.</description></item><item><title>Refresh databases that belongs to Availability Group using dbatools</title><link>https://claudioessilva.eu/2020/05/20/Refresh-databases-that-belongs-to-Availability-Group-using-dbatools/</link><pubDate>Wed, 20 May 2020 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2020/05/20/Refresh-databases-that-belongs-to-Availability-Group-using-dbatools/</guid><description>Few days ago I was surfing on Twitter when dbatools asked about how it&amp;rsquo;s PowerShell module changed the way people work .
Open and check the answers given by the community as there is really good stuff there!
My turn I have shared one of my recipes related to database refreshes. You know, when the client says, &amp;ldquo;please restore this backup or the most recent backup on our instance.&amp;rdquo;. But what if the databases belong to an availability group?</description></item><item><title>More PowerShell Remoting coverage in dbatools</title><link>https://claudioessilva.eu/2019/08/20/More-PowerShell-Remoting-coverage-in-dbatools/</link><pubDate>Tue, 20 Aug 2019 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2019/08/20/More-PowerShell-Remoting-coverage-in-dbatools/</guid><description>Starting on dbatools version 1.0.31 we introduced better coverage for commands that make use of PowerShell Remoting.
Which commands? Commands like Get-DbaComputerCertificate, Get-DbaPrivilege, Get-DbaClientAlias, just to mention a few of them, make use of the internal function Invoke-Command2 which uses New-PSSession when we run it against a remote computer.
&amp;ldquo;Why have you changed it?&amp;rdquo; Let me give you a little bit of background&amp;hellip; At my company, I found that some dbatools commands were not working.</description></item><item><title>dbatools v1.0? It's available - Check it out!</title><link>https://claudioessilva.eu/2019/06/19/dbatools-v1.0-Its-available-Check-it-out/</link><pubDate>Wed, 19 Jun 2019 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2019/06/19/dbatools-v1.0-Its-available-Check-it-out/</guid><description>Dear reader, before continue please open a PowerShell console and run the following command:
Install-Module -Name dbatools If you are doing this on the date of this blog post, you have just installed dbatools v1.0!
After more than 200 commits, the work of more than 20 contributors and 20 days since the last published version, dbatools v1.0 is live!
To all of you that have contributed direct or indirectly to the module a big thank you!</description></item><item><title>'Ups...I have deleted some data. Can you put it back?' - dbatools for the rescue</title><link>https://claudioessilva.eu/2019/05/17/Ups...I-have-deleted-some-data.-Can-you-put-it-back-dbatools-for-the-rescue/</link><pubDate>Fri, 17 May 2019 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2019/05/17/Ups...I-have-deleted-some-data.-Can-you-put-it-back-dbatools-for-the-rescue/</guid><description>Few days ago I received a request to restore a dozen of tables because someone have deleted more data than it was supposed. I immediately thought about dbatools for the job!
NOTE: I also thought about SSMS &amp;ldquo;Import/Export Data&amp;rdquo;. And this is ok when someone says &amp;ldquo;it&amp;rsquo;s to run just once, just now&amp;rdquo;. When you are in the IT for a while you know that is not only once :-). And what if I need to re-run?</description></item><item><title>Scripting SQL Server objects with dbatools - Beyond default options</title><link>https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/</link><pubDate>Wed, 15 May 2019 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2019/05/15/Scripting-SQL-Server-objects-with-dbatools-Beyond-default-options/</guid><description>Probably you had the need to script out some objects from a SQL Server instance/database and this is quite easy. You just need to right click on the object (well&amp;hellip;not on every single one, try it with an Availability Group :-), no script option available) select &amp;ldquo;Script XXXX as&amp;rdquo; and you have it.
But have you realized that this option doesn&amp;rsquo;t bring all the stuff? Let&amp;rsquo;s say you are scripting a table and you have a Non-Clustered index or a trigger&amp;hellip;using this option some of the objects under the table will not be scripted out.</description></item><item><title>Don't cutoff yourself with dates in T-SQL - Did you know...</title><link>https://claudioessilva.eu/2018/09/04/Dont-cutoff-yourself-with-dates-in-T-SQL-Did-you-know.../</link><pubDate>Tue, 04 Sep 2018 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2018/09/04/Dont-cutoff-yourself-with-dates-in-T-SQL-Did-you-know.../</guid><description>Almost all the applications we use have a lot of options. And, sometimes we even stumble across them by accident. Who&amp;rsquo;s ever heard something like &amp;ldquo;Normal user don&amp;rsquo;t even use 5% of Excel capabilities!&amp;rdquo;?
Other options, we know they exist but because the default value it’s ok (so far) we tend to forget it. It is just sitting there, waiting for the day we want/need to change it.
The oddity Few days ago I was talking with a friend that show me some &amp;ldquo;odd behavior&amp;rdquo; when working with dates on SQL Server.</description></item><item><title>Learn, Evolve and Giving Back - TSQL Tuesday 102</title><link>https://claudioessilva.eu/2018/05/08/Learn-Evolve-and-Giving-Back-TSQL-Tuesday-102/</link><pubDate>Tue, 08 May 2018 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2018/05/08/Learn-Evolve-and-Giving-Back-TSQL-Tuesday-102/</guid><description>This month’s T-SQL Tuesday is brought to us by Riley Major‏ ( b | t ) and he encourage us to talk about how we are helping by giving back to our community.
This is the 102nd edition of TSQL2sDay - an Adam Machanic’s ( b | t ) brainchild.
&amp;ldquo;Let&amp;rsquo;s go back for a moment:&amp;rdquo; I have heard about SQL Server the first time back in 2003 when I was on the high school and I had a database class.</description></item><item><title>dbachecks - Going parallel - Cut off your execution times</title><link>https://claudioessilva.eu/2018/04/26/dbachecks-Going-parallel-Cut-off-your-execution-times/</link><pubDate>Thu, 26 Apr 2018 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2018/04/26/dbachecks-Going-parallel-Cut-off-your-execution-times/</guid><description>On one of the last clients I have worked, I have implemented dbachecks in order to get the state of art and know how cool or bad the environments are before start knocking down the bad practices.
This client has seven different environments with more than 100 instances and more than 2000 databases.
Serial execution A non-parallel execution (single session) took more than 2 hours. This is not a big problem when we run it out of hours and we don&amp;rsquo;t want/need to be looking or waiting for it to finish.</description></item><item><title>dbachecks - Setting temporary configuration values</title><link>https://claudioessilva.eu/2018/04/24/dbachecks-Setting-temporary-configuration-values/</link><pubDate>Tue, 24 Apr 2018 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2018/04/24/dbachecks-Setting-temporary-configuration-values/</guid><description>dbachecks has seen the light about two months ago. As I&amp;rsquo;m writing this blog post, the module counts with more than 2600 downloads just from the PowerShell gallery . The module has about 110 configurable checks that make our live easier!
Today I will write about an option that I think users still do not realize that exists.
The default dbachecks works with the values previously saved (for that we use Set-DbcConfig).</description></item><item><title>dbachecks - A different approach for an in-progress and incremental validation</title><link>https://claudioessilva.eu/2018/02/22/dbachecks-A-different-approach-for-an-in-progress-and-incremental-validation/</link><pubDate>Thu, 22 Feb 2018 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2018/02/22/dbachecks-A-different-approach-for-an-in-progress-and-incremental-validation/</guid><description>dbachecks is a new PowerShell module from the SQL Server Community! For more information, read introducing dbachecks .
If you don&amp;rsquo;t know dbachecks, we have released a good amount of blog posts that will help you: Announcing dbachecks – Configurable PowerShell Validation For Your SQL Instances by Rob Sewell introducing dbachecks - a new module from the dbatools team! by Chrissy LeMaire install dbachecks by Chrissy LeMaire dbachecks commands by Chrissy LeMaire dbachecks – Using Power BI dashboards to analyse results by Cláudio Silva My wrapper for dbachecks by Tony Wilhelm Checking backups with dbachecks by Jess Promfret dbachecks please!</description></item><item><title>dbachecks - Using Power BI dashboards to analyse results</title><link>https://claudioessilva.eu/2018/02/22/dbachecks-Using-Power-BI-dashboards-to-analyse-results/</link><pubDate>Thu, 22 Feb 2018 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2018/02/22/dbachecks-Using-Power-BI-dashboards-to-analyse-results/</guid><description>For the last couple of months, members of the dbatools team have been working on a new PowerShell module called dbachecks. This open source PowerShell module will enable you to validate your SQL Instances. Today it is released for you all to start to use 🙂
dbachecks launch - the blog posts series Here you can find a list of the blog posts made available today:
Announcing dbachecks – Configurable PowerShell Validation For Your SQL Instances by Rob Sewell introducing dbachecks - a new module from the dbatools team!</description></item><item><title>Using dbatools to verify your SQL Server instances version compliance</title><link>https://claudioessilva.eu/2018/01/23/Using-dbatools-to-verify-your-SQL-Server-instances-version-compliance/</link><pubDate>Tue, 23 Jan 2018 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2018/01/23/Using-dbatools-to-verify-your-SQL-Server-instances-version-compliance/</guid><description>One of the main DBA&amp;rsquo;s duties is to guarantee that SQL Server instances are up-to-date in terms of patches (Service Packs, Cumulative Updates or Security Updates).
Recently, dbatools added a new command that turns this validation a piece of cake. Thanks to Simone Bizzotto (@niphlod) for baking up the command that Shawn Melton (@wsmelton) and I initially requested.
Some dbatools users already expressed their happiness with the command, like Jess Pomfret did here So, I thought that this information should be shared with other people too.</description></item><item><title>New version of sp_WhoIsActive (v11.20) is available - Deployed on 123 instances in less than 1 minute</title><link>https://claudioessilva.eu/2017/12/05/New-version-of-sp_WhoIsActive-v11.20-is-available-Deployed-on-123-instances-in-less-than-1-minute/</link><pubDate>Tue, 05 Dec 2017 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2017/12/05/New-version-of-sp_WhoIsActive-v11.20-is-available-Deployed-on-123-instances-in-less-than-1-minute/</guid><description>Last night, I received Adam Machanic&amp;rsquo;s ( b | t ) newsletter &amp;ldquo;Announcing sp_whoisactive v11.20: Live Query Plans&amp;rdquo;.
For those who don&amp;rsquo;t know about it, sp_WhoIsActive is a stored procedure that provides detailed information about the sessions running on your SQL Server instance. It is a great tool when we need to troubleshoot some problems such as long-running queries or blocking. (just two examples)
This stored procedure works on any version/edition since SQL Server 2005 SP1.</description></item><item><title>Someone is not following the best practices - dbatools and Pester don't lie!</title><link>https://claudioessilva.eu/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/</link><pubDate>Tue, 12 Sep 2017 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2017/09/12/Someone-is-not-following-the-best-practices-dbatools-and-Pester-dont-lie/</guid><description>This month’s T-SQL Tuesday is brought to us by my good friend Rob Sewell ( b | t ). Together “Let’s get all Posh – What are you going to automate today?”
I have written some blog posts on how I use PowerShell to automate mundane tasks or some other more complex scenarios like: Find and fix SQL Server databases with empty owner property using dbatools PowerShell module or Have you backed up your SQL Logins today?</description></item><item><title>'Invalid class [0x80041010]' error when trying to access SQLServer's WMI classes</title><link>https://claudioessilva.eu/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/</link><pubDate>Thu, 07 Sep 2017 00:00:00 +0000</pubDate><guid>https://claudioessilva.eu/2017/09/07/Invalid-class-0x80041010-error-when-trying-to-access-SQLServers-WMI-classes/</guid><description>I was using open source PowerShell module dbatools ( GitHub repository ) to get the list of SQL Server services I have on a bunch of hosts so I could confirm if they are in &amp;ldquo;running&amp;rdquo; state.
&amp;ndash; Quick note &amp;ndash; For those who don’t know, dbatools is a module, written by the community, that makes SQL Server administration much easier using PowerShell. Today, the module has more than 260 commands.</description></item></channel></rss>