<!doctype html><html lang=en-us><head><script type=application/ld+json>{"@context":"http://schema.org","@type":"Website","@id":"https:\/\/claudioessilva.eu\/","author":{"@type":"Person","name":"Cláudio Silva","image":"https://claudioessilva.eu/img/avatar.jpg"},"name":"Cláudio Silva\u0027s Blog","description":"The idea of this blog post, like many others I write, is to document a workaround solution to my problem. Hopefully I can also help someone that may be looking for the solution for this problem and stumbles accidentally (or not) on my blog.\nScenario I was helping a colleague automating the creation of emails using Microsoft Outlook using PowerShell. The following are configurable options (these will be the parameters of the script):","url":"https:\/\/claudioessilva.eu\/2020\/02\/12\/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround\/","keywords":"[]"}</script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo 0.123.4 with theme Tranquilpeak 0.5.3-BETA"><meta name=author content="Cláudio Silva"><meta name=keywords content><meta name=description content="The idea of this blog post, like many others I write, is to document a workaround solution to my problem. Hopefully I can also help someone that may be looking for the solution for this problem and stumbles accidentally (or not) on my blog.
Scenario I was helping a colleague automating the creation of emails using Microsoft Outlook using PowerShell. The following are configurable options (these will be the parameters of the script):"><meta property="og:description" content="The idea of this blog post, like many others I write, is to document a workaround solution to my problem. Hopefully I can also help someone that may be looking for the solution for this problem and stumbles accidentally (or not) on my blog.
Scenario I was helping a colleague automating the creation of emails using Microsoft Outlook using PowerShell. The following are configurable options (these will be the parameters of the script):"><meta property="og:type" content="article"><meta property="og:title" content="Change Outlook sender mailbox with PowerShell - A workaround"><meta name=twitter:title content="Change Outlook sender mailbox with PowerShell - A workaround"><meta property="og:url" content="https://claudioessilva.eu/2020/02/12/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround/"><meta property="twitter:url" content="https://claudioessilva.eu/2020/02/12/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround/"><meta property="og:site_name" content="Cláudio Silva's Blog"><meta property="og:description" content="The idea of this blog post, like many others I write, is to document a workaround solution to my problem. Hopefully I can also help someone that may be looking for the solution for this problem and stumbles accidentally (or not) on my blog.
Scenario I was helping a colleague automating the creation of emails using Microsoft Outlook using PowerShell. The following are configurable options (these will be the parameters of the script):"><meta name=twitter:description content="The idea of this blog post, like many others I write, is to document a workaround solution to my problem. Hopefully I can also help someone that may be looking for the solution for this problem and stumbles accidentally (or not) on my blog.
Scenario I was helping a colleague automating the creation of emails using Microsoft Outlook using PowerShell. The following are configurable options (these will be the parameters of the script):"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2020-02-12T00:00:00"><meta property="article:modified_time" content="2020-02-12T00:00:00"><meta property="article:tag" content="ComObject"><meta property="article:tag" content="InvokeMember"><meta property="article:tag" content="Mail"><meta property="article:tag" content="Outlook"><meta property="article:tag" content="PowerShell"><meta property="article:tag" content="reflection"><meta property="article:tag" content="Scripting"><meta property="article:tag" content="Security"><meta property="article:tag" content="Sender"><meta property="article:tag" content="SendUsingAccount"><meta property="article:tag" content="SetProperty"><meta property="article:tag" content="syndicated"><meta name=twitter:card content="summary"><meta name=twitter:site content="@claudioessilva"><meta name=twitter:creator content="@claudioessilva"><meta property="og:image" content="https://claudioessilva.eu/img/avatar.jpg"><meta property="twitter:image" content="https://claudioessilva.eu/img/avatar.jpg"><title>Change Outlook sender mailbox with PowerShell - A workaround</title>
<link rel=icon href=https://claudioessilva.eu/img/favicon.jpg><link rel=canonical href=https://claudioessilva.eu/2020/02/12/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://claudioessilva.eu/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-27703765-1","auto"),ga("send","pageview"))</script></head><body><div id=blog><header id=header data-behavior=4><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=/ aria-label="Go to homepage">Cláudio Silva's Blog</a></div><a class=header-right-picture href=/#about aria-label="Open the link: /#about"><img class=header-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"></a></header><nav id=sidebar data-behavior=4><div class=sidebar-container><div class=sidebar-profile><a href=/#about aria-label="Read more about the author"><img class=sidebar-profile-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"></a><h4 class=sidebar-profile-name>Cláudio Silva</h4><h5 class=sidebar-profile-bio>Data Platform Architect and PowerShell lover.</h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/ title=Home><i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden=true></i>
<span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/tags title=Tags><i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden=true></i>
<span class=sidebar-button-desc>Tags</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/#about title=About><i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden=true></i>
<span class=sidebar-button-desc>About</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/claudioessilva target=_blank rel=noopener title=GitHub><i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden=true></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://twitter.com/claudioessilva target=_blank rel=noopener title=Twitter><i class="sidebar-button-icon fab fa-lg fa-twitter" aria-hidden=true></i>
<span class=sidebar-button-desc>Twitter</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://www.linkedin.com/in/claudioessilva target=_blank rel=noopener title=LinkedIn><i class="sidebar-button-icon fab fa-lg fa-linkedin" aria-hidden=true></i>
<span class=sidebar-button-desc>LinkedIn</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/index.xml title=RSS><i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden=true></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul></div><div class=sidebar-container><div style=color:#ebebeb;font-size:25px;text-align:center>dbatools book</div><div style=color:#ebebeb;font-size:15px>Now available! Buy it at manning.com - 50% off with code bldbatools50</div><a href="https://www.manning.com/books/learn-dbatools-in-a-month-of-lunches?utm_source=claudioessilva&utm_medium=affiliate&utm_campaign=affiliate&a_aid=claudioessilva" target=_blank><center><img src=https://images.manning.com/264/352/resize/book/0/998b76f-982a-4661-a020-5d94909f7ea5/LeMaire-HI.png height=300></center></a></div></nav><div id=main data-behavior=4 class=hasCoverMetaIn><article class=post id=top><div class="post-header main-content-wrap text-left"><h1 class=post-title>Change Outlook sender mailbox with PowerShell - A workaround</h1><div class="postShorten-meta post-meta"><time datetime=2020-02-12T00:00:00Z>February 12, 2020</time></div></div><div class="post-content markdown"><div class=main-content-wrap><p>The idea of this blog post, like many others I write, is to document a workaround solution to my problem. Hopefully I can also help someone that may be looking for the solution for this problem and stumbles accidentally (or not) on my blog.</p><h2 id=scenario>Scenario</h2><p>I was helping a colleague automating the creation of emails using Microsoft Outlook using PowerShell. The following are configurable options (these will be the parameters of the script):</p><ul><li>list of TO email addresses</li><li>list of CC email addresses</li><li>Signed and Encrypted (they are being forced)</li><li>Subject</li><li>Keep the default signature but add the message before</li><li>Sender can be different that the default (example: use team&rsquo;s email instead the personal one)</li></ul><p>We can use the COM object to create Outlook objects.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$Outlook = New-Object -ComObject Outlook.Application
</span></span></code></pre></div><p>We need to get the MAPI namespace and logon on the default profile (or existing session)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Get the MAPI namespace.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$namespace = $Outlook.GetNameSpace(<span style=color:#e6db74>&#34;MAPI&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Log on by using the default profile or existing session (no dialog box).</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$namespace.Logon($null, $null, $false, $true);
</span></span></code></pre></div><blockquote><p>Note: To do this you need to be running your PowerShell session with the same privileges. If you are running Outlook as a non-administrator (and you should!) you need to open a PowerShell session with the same privilege level.</p></blockquote><p>Then, we need to create a new Mail item</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create new email</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$Mail = $Outlook.CreateItem(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>$Mail.GetInspector.Activate()
</span></span></code></pre></div><blockquote><p>Note: The second line (<code>Activate()</code>) is being used because the mail will not be sent automatically, it will be a manual process after the colleague checks a couple of things. This way, activate will bring the focus to the window and this way we can see the magic happening!</p></blockquote><p>To set the To and CC (which is optional) emails is easy as setting the properties&rsquo; values.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$Mail.To = $EmailTo
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ($EmailCC) {
</span></span><span style=display:flex><span>   $Mail.Cc = $EmailCC
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Adding the <code>Subject</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$Mail.Subject = $EmailSubject
</span></span></code></pre></div><p>To sign and/or encrypt the email we need to set like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Sign and Encrypt email</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$Mail.PropertyAccessor.SetProperty(<span style=color:#e6db74>&#34;http://schemas.microsoft.com/mapi/proptag/0x6E010003&#34;</span>, 0x03)
</span></span></code></pre></div><p>The possible values are:</p><p>0x00 - Message has no security
0x01 - Message is encrypted
0x02 - Message is signed
0x03 - Message is signed and encrypted</p><h3 id=keeping-the-signature>Keeping the signature</h3><p>After opening the message we can get the current HTML of the body which will include the default signature (with images, links, etc)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Get default signature</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$signature = $Mail.HtmlBody
</span></span></code></pre></div><p>Then we can just add our <code>$EmailHtmlBody</code> parameter and append the <code>$signature</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$Mail.HtmlBody = $EmailHtmlBody + $signature
</span></span></code></pre></div><h3 id=the-problem>The problem</h3><p>Finally, from our list of properties to be changed we have the sender mailbox.</p><p>Using the <code>SendUsingAccount</code> property I tried to set the email address that I wanted. But&mldr;no luck!</p><h3 id=using-get-member-to-know-more>Using <code>Get-Member</code> to know more</h3><p>I took a closer look and using the <code>Get-Member</code> I was able to be sure what data type this property accepts.
<img src=/img/2020/02/sendingusingaccount_datatype.png alt=sendingusingaccount_datatype></p><p>As we can see it expects an object of type <code>Account</code>.</p><h3 id=now-will-work-right>Now will work, right?!</h3><p>To get the account as an <code>account</code> type I have used the following code where the <code>$EmailFrom</code> variable contains the email address I want to use:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Get account object from email addres</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$account = $outlook.Session.Accounts.Item($EmailFrom)
</span></span></code></pre></div><blockquote><p>NOTE: You need to have this email address configured on your Outlook, otherwise this will not work.</p></blockquote><p>With our <code>$account</code> variable set let&rsquo;s assign it to our <code>SendUsingAccount</code> mail object property.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$Mail.SendUsingAccount = $account
</span></span></code></pre></div><p>But&mldr;this also didn&rsquo;t work!
All the others properties were pretty easy to change so I didn&rsquo;t expect that.</p><h2 id=time-for-some-google-fu>Time for some google-fu</h2><p>After googleing for a bit I found an generic (works for many objects) alternative way to set a property to an object</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>function</span> Invoke-SetProperty {
</span></span><span style=display:flex><span>    <span style=color:#75715e># Auxiliar function to set properties. The SendUsingAccount property wouldn&#39;t be set in a different way</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>param</span>(
</span></span><span style=display:flex><span>        [<span style=color:#66d9ef>__ComObject</span>] $Object,
</span></span><span style=display:flex><span>        [<span style=color:#66d9ef>String</span>] $Property,
</span></span><span style=display:flex><span>        $Value
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>Void</span>] $Object.GetType().InvokeMember($Property,<span style=color:#e6db74>&#34;SetProperty&#34;</span>,$NULL,$Object,$Value)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>I have put this code as an internal function. So, inside our code we can call it like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Change Sender mailbox</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Invoke-SetProperty -Object $mail -Property <span style=color:#e6db74>&#34;SendUsingAccount&#34;</span> -Value $account
</span></span></code></pre></div><p>And finally, it worked!</p><h3 id=conclusion>Conclusion</h3><p>In this case we are using <a href=https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/reflection target=_blank rel="noopener noreferrer">reflection
</a>(by calling InvokeMember()) .Normally we use this, for example, when we want to change private properties of an object. I’m not sure in this case why the “normal” way didn’t work but, at least, this can be used as a workaround for the future in case other similar cases appear.</p><h3 id=the-whole-function-code>The whole function code</h3><p>You can get the whole function code from <a href=https://gist.github.com/ClaudioESSilva/dfaf1de2e5da88fca1e59f70edd7f4ae target=_blank rel="noopener noreferrer">here</a></p><h3 id=a-final-curiosity>A final curiosity</h3><p>Normally when talking about automation one of the things that we measure is how much time we can save when in comparison with all the manual steps. Just to kill the curiosity the best case scenario for a manual process (which includes Excel files) takes 1h, after the automation we went down to 30 seconds. However this is a story for a another day with another blog post. Stay tuned!</p><p>Thanks for reading!</p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">TAGGED IN</span><br><a class="tag tag--primary tag--small" href=/tags/ComObject/>ComObject</a>
<a class="tag tag--primary tag--small" href=/tags/InvokeMember/>InvokeMember</a>
<a class="tag tag--primary tag--small" href=/tags/Mail/>Mail</a>
<a class="tag tag--primary tag--small" href=/tags/Outlook/>Outlook</a>
<a class="tag tag--primary tag--small" href=/tags/PowerShell/>PowerShell</a>
<a class="tag tag--primary tag--small" href=/tags/reflection/>reflection</a>
<a class="tag tag--primary tag--small" href=/tags/Scripting/>Scripting</a>
<a class="tag tag--primary tag--small" href=/tags/Security/>Security</a>
<a class="tag tag--primary tag--small" href=/tags/Sender/>Sender</a>
<a class="tag tag--primary tag--small" href=/tags/SendUsingAccount/>SendUsingAccount</a>
<a class="tag tag--primary tag--small" href=/tags/SetProperty/>SetProperty</a>
<a class="tag tag--primary tag--small" href=/tags/syndicated/>syndicated</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2020/02/21/T-SQL-Copy-Paste-Pattern-Increasing-a-performance-problem/ data-tooltip="T-SQL Copy & Paste Pattern - Increasing a performance problem" aria-label="NEXT: T-SQL Copy & Paste Pattern - Increasing a performance problem"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2020/02/04/Temporarily-enable-TLS-1.0/1.1-Be-sure-you-check-this-keys/ data-tooltip="Temporarily enable TLS 1.0/1.1? - Be sure you check this keys" aria-label="PREVIOUS: Temporarily enable TLS 1.0/1.1? - Be sure you check this keys"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://claudioessilva.eu/2020/02/12/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://claudioessilva.eu/2020/02/12/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://claudioessilva.eu/2020/02/12/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div><div class=comments><script src=https://utteranc.es/client.js repo=ClaudioESSilva/blog-comments issue-term=og:title theme=github-light crossorigin=anonymous async></script></div></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2024 Cláudio Silva. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=4><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2020/02/21/T-SQL-Copy-Paste-Pattern-Increasing-a-performance-problem/ data-tooltip="T-SQL Copy & Paste Pattern - Increasing a performance problem" aria-label="NEXT: T-SQL Copy & Paste Pattern - Increasing a performance problem"><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2020/02/04/Temporarily-enable-TLS-1.0/1.1-Be-sure-you-check-this-keys/ data-tooltip="Temporarily enable TLS 1.0/1.1? - Be sure you check this keys" aria-label="PREVIOUS: Temporarily enable TLS 1.0/1.1? - Be sure you check this keys"><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions aria-label="Share this post"><i class="fa fa-share-alt" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://claudioessilva.eu/2020/02/12/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround/" title="Share on Facebook" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://claudioessilva.eu/2020/02/12/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround/" title="Share on Twitter" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https://claudioessilva.eu/2020/02/12/Change-Outlook-sender-mailbox-with-PowerShell-A-workaround/" title="Share on Linkedin" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#top aria-label="Back to top"><i class="fa fa-arrow-up" aria-hidden=true></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=4><i id=btn-close-shareoptions class="fa fa-times"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fclaudioessilva.eu%2F2020%2F02%2F12%2FChange-Outlook-sender-mailbox-with-PowerShell-A-workaround%2F" aria-label="Share on Facebook"><i class="fab fa-facebook-square" aria-hidden=true></i><span>Share on Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fclaudioessilva.eu%2F2020%2F02%2F12%2FChange-Outlook-sender-mailbox-with-PowerShell-A-workaround%2F" aria-label="Share on Twitter"><i class="fab fa-twitter" aria-hidden=true></i><span>Share on Twitter</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fclaudioessilva.eu%2F2020%2F02%2F12%2FChange-Outlook-sender-mailbox-with-PowerShell-A-workaround%2F" aria-label="Share on Linkedin"><i class="fab fa-linkedin" aria-hidden=true></i><span>Share on Linkedin</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-times"></i></div><img id=about-card-picture src=https://claudioessilva.eu/img/avatar.jpg alt="Author's picture"><h4 id=about-card-name>Cláudio Silva</h4><div id=about-card-bio>Data Platform Architect and PowerShell lover.</div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Data Platform Architect</div><div id=about-card-location><i class="fa fa-map-marker-alt"></i><br>Portugal</div></div></div><div id=cover style=background-image:url(https://claudioessilva.eu/images/cover_bridge.jpg)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://claudioessilva.eu/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js></script><script>$(document).ready(function(){hljs.configure({classPrefix:"",useBR:!1}),$("pre.code-highlight > code, pre > code").each(function(e,t){$(this).hasClass("codeblock")||$(this).addClass("codeblock"),hljs.highlightBlock(t)})})</script></body></html>